<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>tsai - Utilities</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="tsai - Utilities">
<meta property="og:description" content="source">
<meta property="og:site-name" content="tsai">
<meta name="twitter:title" content="tsai - Utilities">
<meta name="twitter:description" content="source">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">tsai</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/timeseriesAI/tsai"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Utilities</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">tsai</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorials.html" class="sidebar-item-text sidebar-link">Tutorial notebooks</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.core.html" class="sidebar-item-text sidebar-link">Data Core</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.external.html" class="sidebar-item-text sidebar-link">External data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.preparation.html" class="sidebar-item-text sidebar-link">Data preparation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.validation.html" class="sidebar-item-text sidebar-link">Spliting data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.preprocessing.html" class="sidebar-item-text sidebar-link">Data preprocessing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.unwindowed.html" class="sidebar-item-text sidebar-link">Unwindowed datasets</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.transforms.html" class="sidebar-item-text sidebar-link">Time Series Data Augmentation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.mixed_augmentation.html" class="sidebar-item-text sidebar-link">Label-mixing transforms</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.image.html" class="sidebar-item-text sidebar-link">Imaging Time Series</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.features.html" class="sidebar-item-text sidebar-link">Featurizing Time Series</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.tabular.html" class="sidebar-item-text sidebar-link">Time Series Tabular Data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.mixed.html" class="sidebar-item-text sidebar-link">Mixed data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.metadatasets.html" class="sidebar-item-text sidebar-link">Metadataset</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.layers.html" class="sidebar-item-text sidebar-link">Layers</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.utils.html" class="sidebar-item-text sidebar-link">Model utilities</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">MLPs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.mlp.html" class="sidebar-item-text sidebar-link">MLP</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.gmlp.html" class="sidebar-item-text sidebar-link">gMLP</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">RNNs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rnn.html" class="sidebar-item-text sidebar-link">RNNs</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rnnplus.html" class="sidebar-item-text sidebar-link">RNNPlus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tssequencerplus.html" class="sidebar-item-text sidebar-link">TSSequencerPlus</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">CNNs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.fcn.html" class="sidebar-item-text sidebar-link">FCN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.fcnplus.html" class="sidebar-item-text sidebar-link">FCNPlus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.resnet.html" class="sidebar-item-text sidebar-link">ResNet</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.resnetplus.html" class="sidebar-item-text sidebar-link">ResNetPlus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xresnet1d.html" class="sidebar-item-text sidebar-link">XResNet1d</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xresnet1dplus.html" class="sidebar-item-text sidebar-link">XResNet1dPlus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rescnn.html" class="sidebar-item-text sidebar-link">ResCNN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tcn.html" class="sidebar-item-text sidebar-link">TCN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.inceptiontime.html" class="sidebar-item-text sidebar-link">InceptionTime</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.inceptiontimeplus.html" class="sidebar-item-text sidebar-link">InceptionTimePlus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xceptiontime.html" class="sidebar-item-text sidebar-link">XceptionTime</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xceptiontimeplus.html" class="sidebar-item-text sidebar-link">XceptionTimePlus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.omniscalecnn.html" class="sidebar-item-text sidebar-link">OmniScaleCNN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xcm.html" class="sidebar-item-text sidebar-link">XCM</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.xcmplus.html" class="sidebar-item-text sidebar-link">XCMPlus</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">RNN-CNNs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rnn_fcn.html" class="sidebar-item-text sidebar-link">RNN_FCN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rnn_fcnplus.html" class="sidebar-item-text sidebar-link">RNN_FCNPlus</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">Wavelet-based NNs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.mwdn.html" class="sidebar-item-text sidebar-link">mWDN</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">Transformers</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.positional_encoders.html" class="sidebar-item-text sidebar-link">Positional encoders</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.transformermodel.html" class="sidebar-item-text sidebar-link">TransformerModel</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tst.html" class="sidebar-item-text sidebar-link">TST</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tstplus.html" class="sidebar-item-text sidebar-link">TSTPlus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tsperceiver.html" class="sidebar-item-text sidebar-link">TSPerceiver</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tsitplus.html" class="sidebar-item-text sidebar-link">TSiT</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">ROCKETs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rocket.html" class="sidebar-item-text sidebar-link">ROCKET</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.rocket_pytorch.html" class="sidebar-item-text sidebar-link">ROCKET Pytorch</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.minirocket.html" class="sidebar-item-text sidebar-link">MINIROCKET</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.minirocket_pytorch.html" class="sidebar-item-text sidebar-link">MINIROCKET Pytorch</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.minirocketplus_pytorch.html" class="sidebar-item-text sidebar-link">MINIROCKETPlus Pytorch</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">Tabular models</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tabmodel.html" class="sidebar-item-text sidebar-link">TabModel</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tabtransformer.html" class="sidebar-item-text sidebar-link">TabTransformer</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.gatedtabtransformer.html" class="sidebar-item-text sidebar-link">GatedTabTransformer</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.tabfusiontransformer.html" class="sidebar-item-text sidebar-link">TabFusionTransformer</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false">Miscellaneous</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.multiinputnet.html" class="sidebar-item-text sidebar-link">MultiInputNet</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.misc.html" class="sidebar-item-text sidebar-link">Miscellaneous</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">Training</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./learner.html" class="sidebar-item-text sidebar-link">Learner</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tslearner.html" class="sidebar-item-text sidebar-link">TSLearner</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimizer.html" class="sidebar-item-text sidebar-link">Optimizers</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./metrics.html" class="sidebar-item-text sidebar-link">Metrics</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false">Callbacks</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.core.html" class="sidebar-item-text sidebar-link">Callback</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.predictiondynamics.html" class="sidebar-item-text sidebar-link">PredictionDynamics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.noisy_student.html" class="sidebar-item-text sidebar-link">Noisy student</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.mvp.html" class="sidebar-item-text sidebar-link">MVP (aka TSBERT)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./callback.experimental.html" class="sidebar-item-text sidebar-link">Experimental Callbacks</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calibration.html" class="sidebar-item-text sidebar-link">Calibration</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="true">HPO &amp; experiment tracking</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optuna.html" class="sidebar-item-text sidebar-link">Optuna</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wandb.html" class="sidebar-item-text sidebar-link">Weights &amp; Biases Sweeps</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference.html" class="sidebar-item-text sidebar-link">Inference</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis.html" class="sidebar-item-text sidebar-link">Analysis</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.explainability.html" class="sidebar-item-text sidebar-link">Explainability</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./utils.html" class="sidebar-item-text sidebar-link active">Utilities</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#is_slice" id="toc-is_slice" class="nav-link active" data-scroll-target="#is_slice">is_slice</a></li>
  <li><a href="#is_memmap" id="toc-is_memmap" class="nav-link" data-scroll-target="#is_memmap">is_memmap</a></li>
  <li><a href="#is_dask" id="toc-is_dask" class="nav-link" data-scroll-target="#is_dask">is_dask</a></li>
  <li><a href="#is_zarr" id="toc-is_zarr" class="nav-link" data-scroll-target="#is_zarr">is_zarr</a></li>
  <li><a href="#is_tensor" id="toc-is_tensor" class="nav-link" data-scroll-target="#is_tensor">is_tensor</a></li>
  <li><a href="#is_nparray" id="toc-is_nparray" class="nav-link" data-scroll-target="#is_nparray">is_nparray</a></li>
  <li><a href="#todtype" id="toc-todtype" class="nav-link" data-scroll-target="#todtype">todtype</a></li>
  <li><a href="#to3dplusarray" id="toc-to3dplusarray" class="nav-link" data-scroll-target="#to3dplusarray">to3dPlusArray</a></li>
  <li><a href="#to3dplustensor" id="toc-to3dplustensor" class="nav-link" data-scroll-target="#to3dplustensor">to3dPlusTensor</a></li>
  <li><a href="#to2dplusarray" id="toc-to2dplusarray" class="nav-link" data-scroll-target="#to2dplusarray">to2dPlusArray</a></li>
  <li><a href="#to2dplustensor" id="toc-to2dplustensor" class="nav-link" data-scroll-target="#to2dplustensor">to2dPlusTensor</a></li>
  <li><a href="#to3dplus" id="toc-to3dplus" class="nav-link" data-scroll-target="#to3dplus">to3dPlus</a></li>
  <li><a href="#to2dplus" id="toc-to2dplus" class="nav-link" data-scroll-target="#to2dplus">to2dPlus</a></li>
  <li><a href="#to1d" id="toc-to1d" class="nav-link" data-scroll-target="#to1d">to1d</a></li>
  <li><a href="#to2d" id="toc-to2d" class="nav-link" data-scroll-target="#to2d">to2d</a></li>
  <li><a href="#to3d" id="toc-to3d" class="nav-link" data-scroll-target="#to3d">to3d</a></li>
  <li><a href="#to1darray" id="toc-to1darray" class="nav-link" data-scroll-target="#to1darray">to1darray</a></li>
  <li><a href="#to2darray" id="toc-to2darray" class="nav-link" data-scroll-target="#to2darray">to2darray</a></li>
  <li><a href="#to3darray" id="toc-to3darray" class="nav-link" data-scroll-target="#to3darray">to3darray</a></li>
  <li><a href="#to1dtensor" id="toc-to1dtensor" class="nav-link" data-scroll-target="#to1dtensor">to1dtensor</a></li>
  <li><a href="#to2dtensor" id="toc-to2dtensor" class="nav-link" data-scroll-target="#to2dtensor">to2dtensor</a></li>
  <li><a href="#to3dtensor" id="toc-to3dtensor" class="nav-link" data-scroll-target="#to3dtensor">to3dtensor</a></li>
  <li><a href="#tol" id="toc-tol" class="nav-link" data-scroll-target="#tol">toL</a></li>
  <li><a href="#toarray" id="toc-toarray" class="nav-link" data-scroll-target="#toarray">toarray</a></li>
  <li><a href="#totensor" id="toc-totensor" class="nav-link" data-scroll-target="#totensor">totensor</a></li>
  <li><a href="#get_file_size" id="toc-get_file_size" class="nav-link" data-scroll-target="#get_file_size">get_file_size</a></li>
  <li><a href="#get_dir_size" id="toc-get_dir_size" class="nav-link" data-scroll-target="#get_dir_size">get_dir_size</a></li>
  <li><a href="#get_size" id="toc-get_size" class="nav-link" data-scroll-target="#get_size">get_size</a></li>
  <li><a href="#bytes2gb" id="toc-bytes2gb" class="nav-link" data-scroll-target="#bytes2gb">bytes2GB</a></li>
  <li><a href="#bytes2size" id="toc-bytes2size" class="nav-link" data-scroll-target="#bytes2size">bytes2size</a></li>
  <li><a href="#is_dir" id="toc-is_dir" class="nav-link" data-scroll-target="#is_dir">is_dir</a></li>
  <li><a href="#is_file" id="toc-is_file" class="nav-link" data-scroll-target="#is_file">is_file</a></li>
  <li><a href="#delete_all_in_dir" id="toc-delete_all_in_dir" class="nav-link" data-scroll-target="#delete_all_in_dir">delete_all_in_dir</a></li>
  <li><a href="#reverse_dict" id="toc-reverse_dict" class="nav-link" data-scroll-target="#reverse_dict">reverse_dict</a></li>
  <li><a href="#is_tuple" id="toc-is_tuple" class="nav-link" data-scroll-target="#is_tuple">is_tuple</a></li>
  <li><a href="#itemify" id="toc-itemify" class="nav-link" data-scroll-target="#itemify">itemify</a></li>
  <li><a href="#ifelse" id="toc-ifelse" class="nav-link" data-scroll-target="#ifelse">ifelse</a></li>
  <li><a href="#exists" id="toc-exists" class="nav-link" data-scroll-target="#exists">exists</a></li>
  <li><a href="#isnone" id="toc-isnone" class="nav-link" data-scroll-target="#isnone">isnone</a></li>
  <li><a href="#test_eq_nan" id="toc-test_eq_nan" class="nav-link" data-scroll-target="#test_eq_nan">test_eq_nan</a></li>
  <li><a href="#test_error" id="toc-test_error" class="nav-link" data-scroll-target="#test_error">test_error</a></li>
  <li><a href="#test_not_ok" id="toc-test_not_ok" class="nav-link" data-scroll-target="#test_not_ok">test_not_ok</a></li>
  <li><a href="#test_ok" id="toc-test_ok" class="nav-link" data-scroll-target="#test_ok">test_ok</a></li>
  <li><a href="#test_type" id="toc-test_type" class="nav-link" data-scroll-target="#test_type">test_type</a></li>
  <li><a href="#test_not_close" id="toc-test_not_close" class="nav-link" data-scroll-target="#test_not_close">test_not_close</a></li>
  <li><a href="#is_not_close" id="toc-is_not_close" class="nav-link" data-scroll-target="#is_not_close">is_not_close</a></li>
  <li><a href="#assert_fn" id="toc-assert_fn" class="nav-link" data-scroll-target="#assert_fn">assert_fn</a></li>
  <li><a href="#test_le" id="toc-test_le" class="nav-link" data-scroll-target="#test_le">test_le</a></li>
  <li><a href="#test_lt" id="toc-test_lt" class="nav-link" data-scroll-target="#test_lt">test_lt</a></li>
  <li><a href="#test_ge" id="toc-test_ge" class="nav-link" data-scroll-target="#test_ge">test_ge</a></li>
  <li><a href="#test_gt" id="toc-test_gt" class="nav-link" data-scroll-target="#test_gt">test_gt</a></li>
  <li><a href="#stack_pad" id="toc-stack_pad" class="nav-link" data-scroll-target="#stack_pad">stack_pad</a></li>
  <li><a href="#stack" id="toc-stack" class="nav-link" data-scroll-target="#stack">stack</a></li>
  <li><a href="#pad_sequences" id="toc-pad_sequences" class="nav-link" data-scroll-target="#pad_sequences">pad_sequences</a></li>
  <li><a href="#match_seq_len" id="toc-match_seq_len" class="nav-link" data-scroll-target="#match_seq_len">match_seq_len</a></li>
  <li><a href="#random_shuffle" id="toc-random_shuffle" class="nav-link" data-scroll-target="#random_shuffle">random_shuffle</a></li>
  <li><a href="#cat2int" id="toc-cat2int" class="nav-link" data-scroll-target="#cat2int">cat2int</a></li>
  <li><a href="#cycle_dl_estimate" id="toc-cycle_dl_estimate" class="nav-link" data-scroll-target="#cycle_dl_estimate">cycle_dl_estimate</a></li>
  <li><a href="#cycle_dl_to_device" id="toc-cycle_dl_to_device" class="nav-link" data-scroll-target="#cycle_dl_to_device">cycle_dl_to_device</a></li>
  <li><a href="#cycle_dl" id="toc-cycle_dl" class="nav-link" data-scroll-target="#cycle_dl">cycle_dl</a></li>
  <li><a href="#cache_data" id="toc-cache_data" class="nav-link" data-scroll-target="#cache_data">cache_data</a></li>
  <li><a href="#get_func_defaults" id="toc-get_func_defaults" class="nav-link" data-scroll-target="#get_func_defaults">get_func_defaults</a></li>
  <li><a href="#get_idx_from_df_col_vals" id="toc-get_idx_from_df_col_vals" class="nav-link" data-scroll-target="#get_idx_from_df_col_vals">get_idx_from_df_col_vals</a></li>
  <li><a href="#get_sublist_idxs" id="toc-get_sublist_idxs" class="nav-link" data-scroll-target="#get_sublist_idxs">get_sublist_idxs</a></li>
  <li><a href="#flatten_list" id="toc-flatten_list" class="nav-link" data-scroll-target="#flatten_list">flatten_list</a></li>
  <li><a href="#display_pd_df" id="toc-display_pd_df" class="nav-link" data-scroll-target="#display_pd_df">display_pd_df</a></li>
  <li><a href="#tscore" id="toc-tscore" class="nav-link" data-scroll-target="#tscore">tscore</a></li>
  <li><a href="#kstest" id="toc-kstest" class="nav-link" data-scroll-target="#kstest">kstest</a></li>
  <li><a href="#ttest" id="toc-ttest" class="nav-link" data-scroll-target="#ttest">ttest</a></li>
  <li><a href="#scc" id="toc-scc" class="nav-link" data-scroll-target="#scc">scc</a></li>
  <li><a href="#pcc" id="toc-pcc" class="nav-link" data-scroll-target="#pcc">pcc</a></li>
  <li><a href="#remove_fn" id="toc-remove_fn" class="nav-link" data-scroll-target="#remove_fn">remove_fn</a></li>
  <li><a href="#npsave" id="toc-npsave" class="nav-link" data-scroll-target="#npsave">npsave</a></li>
  <li><a href="#permute_2d" id="toc-permute_2d" class="nav-link" data-scroll-target="#permute_2d">permute_2D</a></li>
  <li><a href="#random_half_normal_tensor" id="toc-random_half_normal_tensor" class="nav-link" data-scroll-target="#random_half_normal_tensor">random_half_normal_tensor</a></li>
  <li><a href="#random_normal_tensor" id="toc-random_normal_tensor" class="nav-link" data-scroll-target="#random_normal_tensor">random_normal_tensor</a></li>
  <li><a href="#random_half_normal" id="toc-random_half_normal" class="nav-link" data-scroll-target="#random_half_normal">random_half_normal</a></li>
  <li><a href="#random_normal" id="toc-random_normal" class="nav-link" data-scroll-target="#random_normal">random_normal</a></li>
  <li><a href="#fig2buf" id="toc-fig2buf" class="nav-link" data-scroll-target="#fig2buf">fig2buf</a></li>
  <li><a href="#get_plot_fig" id="toc-get_plot_fig" class="nav-link" data-scroll-target="#get_plot_fig">get_plot_fig</a></li>
  <li><a href="#default_dpi" id="toc-default_dpi" class="nav-link" data-scroll-target="#default_dpi">default_dpi</a></li>
  <li><a href="#plot_scatter" id="toc-plot_scatter" class="nav-link" data-scroll-target="#plot_scatter">plot_scatter</a></li>
  <li><a href="#get_idxs" id="toc-get_idxs" class="nav-link" data-scroll-target="#get_idxs">get_idxs</a></li>
  <li><a href="#apply_cmap" id="toc-apply_cmap" class="nav-link" data-scroll-target="#apply_cmap">apply_cmap</a></li>
  <li><a href="#torch_tile" id="toc-torch_tile" class="nav-link" data-scroll-target="#torch_tile">torch_tile</a></li>
  <li><a href="#to_tsfresh_df" id="toc-to_tsfresh_df" class="nav-link" data-scroll-target="#to_tsfresh_df">to_tsfresh_df</a></li>
  <li><a href="#scorr" id="toc-scorr" class="nav-link" data-scroll-target="#scorr">scorr</a></li>
  <li><a href="#pcorr" id="toc-pcorr" class="nav-link" data-scroll-target="#pcorr">pcorr</a></li>
  <li><a href="#torch_diff" id="toc-torch_diff" class="nav-link" data-scroll-target="#torch_diff">torch_diff</a></li>
  <li><a href="#torch_clamp" id="toc-torch_clamp" class="nav-link" data-scroll-target="#torch_clamp">torch_clamp</a></li>
  <li><a href="#get_percentile" id="toc-get_percentile" class="nav-link" data-scroll-target="#get_percentile">get_percentile</a></li>
  <li><a href="#clip_outliers" id="toc-clip_outliers" class="nav-link" data-scroll-target="#clip_outliers">clip_outliers</a></li>
  <li><a href="#get_outliers_iqr" id="toc-get_outliers_iqr" class="nav-link" data-scroll-target="#get_outliers_iqr">get_outliers_IQR</a></li>
  <li><a href="#get_robustscale_params" id="toc-get_robustscale_params" class="nav-link" data-scroll-target="#get_robustscale_params">get_robustscale_params</a></li>
  <li><a href="#torch_slice_by_dim" id="toc-torch_slice_by_dim" class="nav-link" data-scroll-target="#torch_slice_by_dim">torch_slice_by_dim</a></li>
  <li><a href="#torch_nanstd" id="toc-torch_nanstd" class="nav-link" data-scroll-target="#torch_nanstd">torch_nanstd</a></li>
  <li><a href="#torch_nanmean" id="toc-torch_nanmean" class="nav-link" data-scroll-target="#torch_nanmean">torch_nanmean</a></li>
  <li><a href="#concat" id="toc-concat" class="nav-link" data-scroll-target="#concat">concat</a></li>
  <li><a href="#reduce_memory_usage" id="toc-reduce_memory_usage" class="nav-link" data-scroll-target="#reduce_memory_usage">reduce_memory_usage</a></li>
  <li><a href="#cls_name" id="toc-cls_name" class="nav-link" data-scroll-target="#cls_name">cls_name</a></li>
  <li><a href="#rotate_axis2" id="toc-rotate_axis2" class="nav-link" data-scroll-target="#rotate_axis2">rotate_axis2</a></li>
  <li><a href="#rotate_axis1" id="toc-rotate_axis1" class="nav-link" data-scroll-target="#rotate_axis1">rotate_axis1</a></li>
  <li><a href="#rotate_axis0" id="toc-rotate_axis0" class="nav-link" data-scroll-target="#rotate_axis0">rotate_axis0</a></li>
  <li><a href="#random_roll3d" id="toc-random_roll3d" class="nav-link" data-scroll-target="#random_roll3d">random_roll3d</a></li>
  <li><a href="#random_roll2d" id="toc-random_roll2d" class="nav-link" data-scroll-target="#random_roll2d">random_roll2d</a></li>
  <li><a href="#roll3d" id="toc-roll3d" class="nav-link" data-scroll-target="#roll3d">roll3d</a></li>
  <li><a href="#roll2d" id="toc-roll2d" class="nav-link" data-scroll-target="#roll2d">roll2d</a></li>
  <li><a href="#chunks_calculator" id="toc-chunks_calculator" class="nav-link" data-scroll-target="#chunks_calculator">chunks_calculator</a></li>
  <li><a href="#is_memory_shared" id="toc-is_memory_shared" class="nav-link" data-scroll-target="#is_memory_shared">is_memory_shared</a></li>
  <li><a href="#assign_in_chunks" id="toc-assign_in_chunks" class="nav-link" data-scroll-target="#assign_in_chunks">assign_in_chunks</a></li>
  <li><a href="#create_array" id="toc-create_array" class="nav-link" data-scroll-target="#create_array">create_array</a></li>
  <li><a href="#np_load_compressed" id="toc-np_load_compressed" class="nav-link" data-scroll-target="#np_load_compressed">np_load_compressed</a></li>
  <li><a href="#np_save_compressed" id="toc-np_save_compressed" class="nav-link" data-scroll-target="#np_save_compressed">np_save_compressed</a></li>
  <li><a href="#np2memmap" id="toc-np2memmap" class="nav-link" data-scroll-target="#np2memmap">np2memmap</a></li>
  <li><a href="#torch_mean_groupby" id="toc-torch_mean_groupby" class="nav-link" data-scroll-target="#torch_mean_groupby">torch_mean_groupby</a></li>
  <li><a href="#torch_flip" id="toc-torch_flip" class="nav-link" data-scroll-target="#torch_flip">torch_flip</a></li>
  <li><a href="#torch_masked_to_num" id="toc-torch_masked_to_num" class="nav-link" data-scroll-target="#torch_masked_to_num">torch_masked_to_num</a></li>
  <li><a href="#torch_nan_to_num" id="toc-torch_nan_to_num" class="nav-link" data-scroll-target="#torch_nan_to_num">torch_nan_to_num</a></li>
  <li><a href="#mpl_trend" id="toc-mpl_trend" class="nav-link" data-scroll-target="#mpl_trend">mpl_trend</a></li>
  <li><a href="#array2digits" id="toc-array2digits" class="nav-link" data-scroll-target="#array2digits">array2digits</a></li>
  <li><a href="#int2digits" id="toc-int2digits" class="nav-link" data-scroll-target="#int2digits">int2digits</a></li>
  <li><a href="#sincos_encoding" id="toc-sincos_encoding" class="nav-link" data-scroll-target="#sincos_encoding">sincos_encoding</a></li>
  <li><a href="#linear_encoding" id="toc-linear_encoding" class="nav-link" data-scroll-target="#linear_encoding">linear_encoding</a></li>
  <li><a href="#encode_positions" id="toc-encode_positions" class="nav-link" data-scroll-target="#encode_positions">encode_positions</a></li>
  <li><a href="#sort_generator" id="toc-sort_generator" class="nav-link" data-scroll-target="#sort_generator">sort_generator</a></li>
  <li><a href="#get_subset_dict" id="toc-get_subset_dict" class="nav-link" data-scroll-target="#get_subset_dict">get_subset_dict</a></li>
  <li><a href="#remove_dir" id="toc-remove_dir" class="nav-link" data-scroll-target="#remove_dir">remove_dir</a></li>
  <li><a href="#create_dir" id="toc-create_dir" class="nav-link" data-scroll-target="#create_dir">create_dir</a></li>
  <li><a href="#named_partial" id="toc-named_partial" class="nav-link" data-scroll-target="#named_partial">named_partial</a></li>
  <li><a href="#yaml2dict" id="toc-yaml2dict" class="nav-link" data-scroll-target="#yaml2dict">yaml2dict</a></li>
  <li><a href="#get_cat_cols" id="toc-get_cat_cols" class="nav-link" data-scroll-target="#get_cat_cols">get_cat_cols</a></li>
  <li><a href="#get_cont_cols" id="toc-get_cont_cols" class="nav-link" data-scroll-target="#get_cont_cols">get_cont_cols</a></li>
  <li><a href="#str2index" id="toc-str2index" class="nav-link" data-scroll-target="#str2index">str2index</a></li>
  <li><a href="#str2list" id="toc-str2list" class="nav-link" data-scroll-target="#str2list">str2list</a></li>
  <li><a href="#map_array" id="toc-map_array" class="nav-link" data-scroll-target="#map_array">map_array</a></li>
  <li><a href="#get_mapping" id="toc-get_mapping" class="nav-link" data-scroll-target="#get_mapping">get_mapping</a></li>
  <li><a href="#log_tfm" id="toc-log_tfm" class="nav-link" data-scroll-target="#log_tfm">log_tfm</a></li>
  <li><a href="#to_sincos_time" id="toc-to_sincos_time" class="nav-link" data-scroll-target="#to_sincos_time">to_sincos_time</a></li>
  <li><a href="#plot_feature_dist" id="toc-plot_feature_dist" class="nav-link" data-scroll-target="#plot_feature_dist">plot_feature_dist</a></li>
  <li><a href="#rolling_moving_average" id="toc-rolling_moving_average" class="nav-link" data-scroll-target="#rolling_moving_average">rolling_moving_average</a></li>
  <li><a href="#fbfill_sequence" id="toc-fbfill_sequence" class="nav-link" data-scroll-target="#fbfill_sequence">fbfill_sequence</a></li>
  <li><a href="#bfill_sequence" id="toc-bfill_sequence" class="nav-link" data-scroll-target="#bfill_sequence">bfill_sequence</a></li>
  <li><a href="#ffill_sequence" id="toc-ffill_sequence" class="nav-link" data-scroll-target="#ffill_sequence">ffill_sequence</a></li>
  <li><a href="#dummify" id="toc-dummify" class="nav-link" data-scroll-target="#dummify">dummify</a></li>
  <li><a href="#shuffle_along_axis" id="toc-shuffle_along_axis" class="nav-link" data-scroll-target="#shuffle_along_axis">shuffle_along_axis</a></li>
  <li><a href="#analyze_array" id="toc-analyze_array" class="nav-link" data-scroll-target="#analyze_array">analyze_array</a></li>
  <li><a href="#analyze_feature" id="toc-analyze_feature" class="nav-link" data-scroll-target="#analyze_feature">analyze_feature</a></li>
  <li><a href="#get_relpath" id="toc-get_relpath" class="nav-link" data-scroll-target="#get_relpath">get_relpath</a></li>
  <li><a href="#split_in_chunks" id="toc-split_in_chunks" class="nav-link" data-scroll-target="#split_in_chunks">split_in_chunks</a></li>
  <li><a href="#load_object" id="toc-load_object" class="nav-link" data-scroll-target="#load_object">load_object</a></li>
  <li><a href="#save_object" id="toc-save_object" class="nav-link" data-scroll-target="#save_object">save_object</a></li>
  <li><a href="#get_idxs_to_keep" id="toc-get_idxs_to_keep" class="nav-link" data-scroll-target="#get_idxs_to_keep">get_idxs_to_keep</a></li>
  <li><a href="#zerofy" id="toc-zerofy" class="nav-link" data-scroll-target="#zerofy">zerofy</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/timeseriesAI/tsai/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Utilities</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<blockquote class="blockquote">
<p>General helper functions used throughout the library</p>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L42" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="is_slice" class="level3">
<h3 class="anchored" data-anchor-id="is_slice">is_slice</h3>
<blockquote class="blockquote">
<pre><code> is_slice (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L41" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_memmap" class="level3">
<h3 class="anchored" data-anchor-id="is_memmap">is_memmap</h3>
<blockquote class="blockquote">
<pre><code> is_memmap (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L40" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_dask" class="level3">
<h3 class="anchored" data-anchor-id="is_dask">is_dask</h3>
<blockquote class="blockquote">
<pre><code> is_dask (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L39" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_zarr" class="level3">
<h3 class="anchored" data-anchor-id="is_zarr">is_zarr</h3>
<blockquote class="blockquote">
<pre><code> is_zarr (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L38" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_tensor" class="level3">
<h3 class="anchored" data-anchor-id="is_tensor">is_tensor</h3>
<blockquote class="blockquote">
<pre><code> is_tensor (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L37" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_nparray" class="level3">
<h3 class="anchored" data-anchor-id="is_nparray">is_nparray</h3>
<blockquote class="blockquote">
<pre><code> is_nparray (o)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ensure these folders exist for testing purposes</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fns <span class="op">=</span> [<span class="st">'data'</span>, <span class="st">'export'</span>, <span class="st">'models'</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fn <span class="kw">in</span> fns: </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> Path(<span class="st">'.'</span>)<span class="op">/</span>fn</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> os.path.exists(path): os.makedirs(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L165" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="todtype" class="level3">
<h3 class="anchored" data-anchor-id="todtype">todtype</h3>
<blockquote class="blockquote">
<pre><code> todtype (dtype)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L161" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to3dplusarray" class="level3">
<h3 class="anchored" data-anchor-id="to3dplusarray">to3dPlusArray</h3>
<blockquote class="blockquote">
<pre><code> to3dPlusArray (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L157" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to3dplustensor" class="level3">
<h3 class="anchored" data-anchor-id="to3dplustensor">to3dPlusTensor</h3>
<blockquote class="blockquote">
<pre><code> to3dPlusTensor (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L153" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to2dplusarray" class="level3">
<h3 class="anchored" data-anchor-id="to2dplusarray">to2dPlusArray</h3>
<blockquote class="blockquote">
<pre><code> to2dPlusArray (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L149" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to2dplustensor" class="level3">
<h3 class="anchored" data-anchor-id="to2dplustensor">to2dPlusTensor</h3>
<blockquote class="blockquote">
<pre><code> to2dPlusTensor (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L143" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to3dplus" class="level3">
<h3 class="anchored" data-anchor-id="to3dplus">to3dPlus</h3>
<blockquote class="blockquote">
<pre><code> to3dPlus (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L137" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to2dplus" class="level3">
<h3 class="anchored" data-anchor-id="to2dplus">to2dPlus</h3>
<blockquote class="blockquote">
<pre><code> to2dPlus (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L131" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to1d" class="level3">
<h3 class="anchored" data-anchor-id="to1d">to1d</h3>
<blockquote class="blockquote">
<pre><code> to1d (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L125" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to2d" class="level3">
<h3 class="anchored" data-anchor-id="to2d">to2d</h3>
<blockquote class="blockquote">
<pre><code> to2d (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L119" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to3d" class="level3">
<h3 class="anchored" data-anchor-id="to3d">to3d</h3>
<blockquote class="blockquote">
<pre><code> to3d (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L111" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to1darray" class="level3">
<h3 class="anchored" data-anchor-id="to1darray">to1darray</h3>
<blockquote class="blockquote">
<pre><code> to1darray (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L103" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to2darray" class="level3">
<h3 class="anchored" data-anchor-id="to2darray">to2darray</h3>
<blockquote class="blockquote">
<pre><code> to2darray (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L95" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to3darray" class="level3">
<h3 class="anchored" data-anchor-id="to3darray">to3darray</h3>
<blockquote class="blockquote">
<pre><code> to3darray (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L87" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to1dtensor" class="level3">
<h3 class="anchored" data-anchor-id="to1dtensor">to1dtensor</h3>
<blockquote class="blockquote">
<pre><code> to1dtensor (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L79" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to2dtensor" class="level3">
<h3 class="anchored" data-anchor-id="to2dtensor">to2dtensor</h3>
<blockquote class="blockquote">
<pre><code> to2dtensor (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L71" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to3dtensor" class="level3">
<h3 class="anchored" data-anchor-id="to3dtensor">to3dtensor</h3>
<blockquote class="blockquote">
<pre><code> to3dtensor (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L63" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="tol" class="level3">
<h3 class="anchored" data-anchor-id="tol">toL</h3>
<blockquote class="blockquote">
<pre><code> toL (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L54" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="toarray" class="level3">
<h3 class="anchored" data-anchor-id="toarray">toarray</h3>
<blockquote class="blockquote">
<pre><code> toarray (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L45" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="totensor" class="level3">
<h3 class="anchored" data-anchor-id="totensor">totensor</h3>
<blockquote class="blockquote">
<pre><code> totensor (o)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">100</span>).astype(np.float32)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> torch.from_numpy(a).<span class="bu">float</span>()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>test_eq(totensor(a), b)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>test_eq(a, toarray(b))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>test_eq(to3dtensor(a).ndim, <span class="dv">3</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>test_eq(to2dtensor(a).ndim, <span class="dv">2</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>test_eq(to1dtensor(a).ndim, <span class="dv">1</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>test_eq(to3darray(b).ndim, <span class="dv">3</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>test_eq(to2darray(b).ndim, <span class="dv">2</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>test_eq(to1darray(b).ndim, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.rand(<span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'target'</span>] <span class="op">=</span> np.random.randint(<span class="dv">0</span>, <span class="dv">3</span>, <span class="bu">len</span>(df))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df[df.columns[:<span class="op">-</span><span class="dv">1</span>]]</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'target'</span>]</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>test_eq(to3darray(X).shape, (<span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">20</span>))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>test_eq(toarray(y).shape, (<span class="dv">10</span>,))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L217" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_file_size" class="level3">
<h3 class="anchored" data-anchor-id="get_file_size">get_file_size</h3>
<blockquote class="blockquote">
<pre><code> get_file_size (file_path:str, return_str:bool=True, decimals:int=2)</code></pre>
</blockquote>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>file_path</td>
<td>str</td>
<td></td>
<td>path to file</td>
</tr>
<tr class="even">
<td>return_str</td>
<td>bool</td>
<td>True</td>
<td>True returns size in human-readable format (KB, MB, GB, …). False in bytes.</td>
</tr>
<tr class="odd">
<td>decimals</td>
<td>int</td>
<td>2</td>
<td>Number of decimals in the output</td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L197" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_dir_size" class="level3">
<h3 class="anchored" data-anchor-id="get_dir_size">get_dir_size</h3>
<blockquote class="blockquote">
<pre><code> get_dir_size (dir_path:str, return_str:bool=True, decimals:int=2,
               verbose:bool=False)</code></pre>
</blockquote>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>dir_path</td>
<td>str</td>
<td></td>
<td>path to directory</td>
</tr>
<tr class="even">
<td>return_str</td>
<td>bool</td>
<td>True</td>
<td>True returns size in human-readable format (KB, MB, GB, …). False in bytes.</td>
</tr>
<tr class="odd">
<td>decimals</td>
<td>int</td>
<td>2</td>
<td>Number of decimals in the output</td>
</tr>
<tr class="even">
<td>verbose</td>
<td>bool</td>
<td>False</td>
<td>Controls verbosity</td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L188" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_size" class="level3">
<h3 class="anchored" data-anchor-id="get_size">get_size</h3>
<blockquote class="blockquote">
<pre><code> get_size (o, return_str:bool=True, decimals:int=2)</code></pre>
</blockquote>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>o</td>
<td></td>
<td></td>
<td>Any object</td>
</tr>
<tr class="even">
<td>return_str</td>
<td>bool</td>
<td>True</td>
<td>True returns size in human-readable format (KB, MB, GB, …). False in bytes.</td>
</tr>
<tr class="odd">
<td>decimals</td>
<td>int</td>
<td>2</td>
<td>Number of decimals in the output</td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L185" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="bytes2gb" class="level3">
<h3 class="anchored" data-anchor-id="bytes2gb">bytes2GB</h3>
<blockquote class="blockquote">
<pre><code> bytes2GB (byts)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L174" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="bytes2size" class="level3">
<h3 class="anchored" data-anchor-id="bytes2size">bytes2size</h3>
<blockquote class="blockquote">
<pre><code> bytes2size (size_bytes:int, decimals=2)</code></pre>
</blockquote>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>size_bytes</td>
<td>int</td>
<td></td>
<td>Number of bytes</td>
</tr>
<tr class="even">
<td>decimals</td>
<td>int</td>
<td>2</td>
<td>Number of decimals in the output</td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>str</strong></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">3</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>test_eq(get_size(a, <span class="va">True</span>, <span class="dv">1</span>), <span class="st">'1.3 KB'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L232" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_dir" class="level3">
<h3 class="anchored" data-anchor-id="is_dir">is_dir</h3>
<blockquote class="blockquote">
<pre><code> is_dir (path)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L229" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_file" class="level3">
<h3 class="anchored" data-anchor-id="is_file">is_file</h3>
<blockquote class="blockquote">
<pre><code> is_file (path)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>test_eq(is_file(<span class="st">"002_utils.ipynb"</span>), <span class="va">True</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>test_eq(is_file(<span class="st">"utils.ipynb"</span>), <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L236" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="delete_all_in_dir" class="level3">
<h3 class="anchored" data-anchor-id="delete_all_in_dir">delete_all_in_dir</h3>
<blockquote class="blockquote">
<pre><code> delete_all_in_dir (tgt_dir, exception=None)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L246" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="reverse_dict" class="level3">
<h3 class="anchored" data-anchor-id="reverse_dict">reverse_dict</h3>
<blockquote class="blockquote">
<pre><code> reverse_dict (dictionary)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L250" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_tuple" class="level3">
<h3 class="anchored" data-anchor-id="is_tuple">is_tuple</h3>
<blockquote class="blockquote">
<pre><code> is_tuple (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L253" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="itemify" class="level3">
<h3 class="anchored" data-anchor-id="itemify">itemify</h3>
<blockquote class="blockquote">
<pre><code> itemify (*o, tup_id=None)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(itemify(a, b))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">len</span>(itemify(a, b)), <span class="bu">len</span>(a))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="va">None</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(itemify(a, b))</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">len</span>(itemify(a, b)), <span class="bu">len</span>(a))</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="va">None</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(itemify(a, b, c))</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">len</span>(itemify(a, b, c)), <span class="bu">len</span>(a))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[(1, 4), (2, 5), (3, 6)]
[(1,), (2,), (3,)]
[(1, 4), (2, 5), (3, 6)]</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L265" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="ifelse" class="level3">
<h3 class="anchored" data-anchor-id="ifelse">ifelse</h3>
<blockquote class="blockquote">
<pre><code> ifelse (a, b, c)</code></pre>
</blockquote>
<p><code>b</code> if <code>a</code> is True else <code>c</code></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L263" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="exists" class="level3">
<h3 class="anchored" data-anchor-id="exists">exists</h3>
<blockquote class="blockquote">
<pre><code> exists (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L260" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="isnone" class="level3">
<h3 class="anchored" data-anchor-id="isnone">isnone</h3>
<blockquote class="blockquote">
<pre><code> isnone (o)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array(<span class="dv">3</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>test_eq(isnone(a), <span class="va">False</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>test_eq(exists(a), <span class="va">True</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="va">None</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>test_eq(isnone(b), <span class="va">True</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>test_eq(exists(b), <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L311" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_eq_nan" class="level3">
<h3 class="anchored" data-anchor-id="test_eq_nan">test_eq_nan</h3>
<blockquote class="blockquote">
<pre><code> test_eq_nan (a, b)</code></pre>
</blockquote>
<p><code>test</code> that <code>a==b</code> excluding nan values (valid for torch.Tensor and np.ndarray)</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L306" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_error" class="level3">
<h3 class="anchored" data-anchor-id="test_error">test_error</h3>
<blockquote class="blockquote">
<pre><code> test_error (error, f, *args, **kwargs)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L297" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_not_ok" class="level3">
<h3 class="anchored" data-anchor-id="test_not_ok">test_not_ok</h3>
<blockquote class="blockquote">
<pre><code> test_not_ok (f, *args, **kwargs)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L288" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_ok" class="level3">
<h3 class="anchored" data-anchor-id="test_ok">test_ok</h3>
<blockquote class="blockquote">
<pre><code> test_ok (f, *args, **kwargs)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L284" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_type" class="level3">
<h3 class="anchored" data-anchor-id="test_type">test_type</h3>
<blockquote class="blockquote">
<pre><code> test_type (a, b)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L279" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_not_close" class="level3">
<h3 class="anchored" data-anchor-id="test_not_close">test_not_close</h3>
<blockquote class="blockquote">
<pre><code> test_not_close (a, b, eps=1e-05)</code></pre>
</blockquote>
<p><code>test</code> that <code>a</code> is within <code>eps</code> of <code>b</code></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L270" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_not_close" class="level3">
<h3 class="anchored" data-anchor-id="is_not_close">is_not_close</h3>
<blockquote class="blockquote">
<pre><code> is_not_close (a, b, eps=1e-05)</code></pre>
</blockquote>
<p>Is <code>a</code> within <code>eps</code> of <code>b</code></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L318" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="assert_fn" class="level3">
<h3 class="anchored" data-anchor-id="assert_fn">assert_fn</h3>
<blockquote class="blockquote">
<pre><code> assert_fn (*args, **kwargs)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L334" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_le" class="level3">
<h3 class="anchored" data-anchor-id="test_le">test_le</h3>
<blockquote class="blockquote">
<pre><code> test_le (a, b)</code></pre>
</blockquote>
<p><code>test</code> that <code>a&gt;b</code></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L330" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_lt" class="level3">
<h3 class="anchored" data-anchor-id="test_lt">test_lt</h3>
<blockquote class="blockquote">
<pre><code> test_lt (a, b)</code></pre>
</blockquote>
<p><code>test</code> that <code>a&gt;b</code></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L326" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_ge" class="level3">
<h3 class="anchored" data-anchor-id="test_ge">test_ge</h3>
<blockquote class="blockquote">
<pre><code> test_ge (a, b)</code></pre>
</blockquote>
<p><code>test</code> that <code>a&gt;=b</code></p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L322" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="test_gt" class="level3">
<h3 class="anchored" data-anchor-id="test_gt">test_gt</h3>
<blockquote class="blockquote">
<pre><code> test_gt (a, b)</code></pre>
</blockquote>
<p><code>test</code> that <code>a&gt;b</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>test_ok(test_gt, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>test_not_ok(test_gt, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>test_ok(test_ge, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>test_not_ok(test_ge, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>test_ok(test_lt, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>test_not_ok(test_lt, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>test_ok(test_le, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>test_not_ok(test_le, <span class="dv">5</span>, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.rand(<span class="dv">100</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>t[t<span class="op">&lt;</span><span class="fl">.5</span>] <span class="op">=</span> np.nan</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>test_ne(t, t)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>test_eq_nan(t, t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L347" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="stack_pad" class="level3">
<h3 class="anchored" data-anchor-id="stack_pad">stack_pad</h3>
<blockquote class="blockquote">
<pre><code> stack_pad (o, padding_value=nan)</code></pre>
</blockquote>
<p>Converts a an iterable into a numpy array using padding if necessary</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L339" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="stack" class="level3">
<h3 class="anchored" data-anchor-id="stack">stack</h3>
<blockquote class="blockquote">
<pre><code> stack (o, axis=0, retain=True)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> [[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>]]</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>test_eq(stack_pad(o).shape, (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">type</span>(stack_pad(o)), np.ndarray)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>test_eq(np.isnan(stack_pad(o)).<span class="bu">sum</span>(), <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/nacho/opt/anaconda3/envs/py37torch112/lib/python3.7/site-packages/ipykernel_launcher.py:13: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  del sys.path[0]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stack_pad(o))</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>test_eq(stack_pad(o), np.array([[<span class="fl">3.</span>]]))</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> [<span class="dv">4</span>,<span class="dv">5</span>]</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stack_pad(o))</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>test_eq(stack_pad(o), np.array([[<span class="fl">4.</span>, <span class="fl">5.</span>]]))</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> [[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>]]</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stack_pad(o))</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> np.array([<span class="dv">0</span>, [<span class="dv">1</span>,<span class="dv">2</span>]], dtype<span class="op">=</span><span class="bu">object</span>)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stack_pad(o))</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> np.array([[[<span class="dv">0</span>], [<span class="dv">10</span>, <span class="dv">20</span>], [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>]], [[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">10</span>, <span class="dv">20</span>], [<span class="dv">100</span>]]], dtype<span class="op">=</span><span class="bu">object</span>)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stack_pad(o))</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> np.array([<span class="dv">0</span>, [<span class="dv">10</span>, <span class="dv">20</span>]], dtype<span class="op">=</span><span class="bu">object</span>)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stack_pad(o))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[3.]]
[[4. 5.]]
[[[ 0.  1.  2. nan]
  [ 4.  5.  6.  7.]]]
[[ 0. nan]
 [ 1.  2.]]
[[[  0.  nan  nan  nan]
  [ 10.  20.  nan  nan]
  [100. 200. 300.  nan]]

 [[  0.   1.   2.   3.]
  [ 10.  20.  nan  nan]
  [100.  nan  nan  nan]]]
[[ 0. nan]
 [10. 20.]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/nacho/opt/anaconda3/envs/py37torch112/lib/python3.7/site-packages/ipykernel_launcher.py:13: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
  del sys.path[0]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.from_numpy(a)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>test_eq_type(stack(itemify(a, tup_id<span class="op">=</span><span class="dv">0</span>)), a)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>test_eq_type(stack(itemify(t, tup_id<span class="op">=</span><span class="dv">0</span>)), t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L370" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="pad_sequences" class="level3">
<h3 class="anchored" data-anchor-id="pad_sequences">pad_sequences</h3>
<blockquote class="blockquote">
<pre><code> pad_sequences (o, maxlen:int=None,
                dtype:(&lt;class'str'&gt;,&lt;class'type'&gt;)=&lt;class
                'numpy.float64'&gt;, padding:str='pre', truncating:str='pre',
                padding_value:float=nan)</code></pre>
</blockquote>
<p>Transforms an iterable with sequences into a 3d numpy array using padding or truncating sequences if necessary</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>o</td>
<td></td>
<td></td>
<td>Iterable object</td>
</tr>
<tr class="even">
<td>maxlen</td>
<td>int</td>
<td>None</td>
<td>Optional max length of the output. If None, max length of the longest individual sequence.</td>
</tr>
<tr class="odd">
<td>dtype</td>
<td>(&lt;class ‘str’&gt;, &lt;class ‘type’&gt;)</td>
<td>float64</td>
<td>Type of the output sequences. To pad sequences with variable length strings, you can use object.</td>
</tr>
<tr class="even">
<td>padding</td>
<td>str</td>
<td>pre</td>
<td>‘pre’ or ‘post’ pad either before or after each sequence.</td>
</tr>
<tr class="odd">
<td>truncating</td>
<td>str</td>
<td>pre</td>
<td>‘pre’ or ‘post’ remove values from sequences larger than maxlen, either at the beginning or at the end of the sequences.</td>
</tr>
<tr class="even">
<td>padding_value</td>
<td>float</td>
<td>nan</td>
<td>Value used for padding.</td>
</tr>
</tbody>
</table>
<p>This function transforms a list (of length n_samples) of sequences into a 3d numpy array of shape:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>                          <span class="ex">[n_samples</span> x n_vars x seq_len]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>seq_len is either the maxlen argument if provided, or the length of the longest sequence in the list.</p>
<p>Sequences that are shorter than seq_len are padded with value until they are seq_len long.</p>
<p>Sequences longer than seq_len are truncated so that they fit the desired length.</p>
<p>The position where padding or truncation happens is determined by the arguments padding and truncating, respectively. Pre-padding or removing values from the beginning of the sequence is the default.</p>
<p>Input sequences to pad_sequences may be have 1, 2 or 3 dimensions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 dim</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.arange(<span class="dv">6</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> np.arange(<span class="dv">3</span>) <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> np.arange(<span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>o  <span class="op">=</span> [a1, a2, a3]</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>padded_o <span class="op">=</span> pad_sequences(o, maxlen<span class="op">=</span><span class="dv">4</span>, dtype<span class="op">=</span>np.float64, padding<span class="op">=</span><span class="st">'post'</span>, truncating<span class="op">=</span><span class="st">'pre'</span>, padding_value<span class="op">=</span>np.nan)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>test_eq(padded_o.shape, (<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>))</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>padded_o</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[  2.,   3.,   4.,   5.]],

       [[  0.,  10.,  20.,  nan]],

       [[  0., 100.,  nan,  nan]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 dim</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.arange(<span class="dv">12</span>).reshape(<span class="dv">2</span>, <span class="dv">6</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> np.arange(<span class="dv">6</span>).reshape(<span class="dv">2</span>, <span class="dv">3</span>) <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> np.arange(<span class="dv">4</span>).reshape(<span class="dv">2</span>, <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>o  <span class="op">=</span> [a1, a2, a3]</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>padded_o <span class="op">=</span> pad_sequences(o, maxlen<span class="op">=</span><span class="dv">4</span>, dtype<span class="op">=</span>np.float64, padding<span class="op">=</span><span class="st">'post'</span>, truncating<span class="op">=</span><span class="st">'pre'</span>, padding_value<span class="op">=</span>np.nan)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>test_eq(padded_o.shape, (<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>padded_o</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[  2.,   3.,   4.,   5.],
        [  8.,   9.,  10.,  11.]],

       [[  0.,  10.,  20.,  nan],
        [ 30.,  40.,  50.,  nan]],

       [[  0., 100.,  nan,  nan],
        [200., 300.,  nan,  nan]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 dim</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.arange(<span class="dv">10</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> np.arange(<span class="dv">6</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> np.arange(<span class="dv">4</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>o  <span class="op">=</span> [a1, a2, a3]</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>padded_o <span class="op">=</span> pad_sequences(o, maxlen<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span>np.float64, padding<span class="op">=</span><span class="st">'pre'</span>, truncating<span class="op">=</span><span class="st">'pre'</span>, padding_value<span class="op">=</span>np.nan)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>test_eq(padded_o.shape, (<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>))</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>padded_o</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[  0.,   1.,   2.,   3.,   4.],
        [  5.,   6.,   7.,   8.,   9.]],

       [[ nan,  nan,   0.,  10.,  20.],
        [ nan,  nan,  30.,  40.,  50.]],

       [[ nan,  nan,  nan,   0., 100.],
        [ nan,  nan,  nan, 200., 300.]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 dim</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.arange(<span class="dv">10</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> np.arange(<span class="dv">6</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> np.arange(<span class="dv">4</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>o  <span class="op">=</span> [a1, a2, a3]</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>padded_o <span class="op">=</span> pad_sequences(o, maxlen<span class="op">=</span><span class="dv">4</span>, dtype<span class="op">=</span>np.float64, padding<span class="op">=</span><span class="st">'pre'</span>, truncating<span class="op">=</span><span class="st">'pre'</span>, padding_value<span class="op">=</span>np.nan)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>test_eq(padded_o.shape, (<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>padded_o</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[  1.,   2.,   3.,   4.],
        [  6.,   7.,   8.,   9.]],

       [[ nan,   0.,  10.,  20.],
        [ nan,  30.,  40.,  50.]],

       [[ nan,  nan,   0., 100.],
        [ nan,  nan, 200., 300.]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 dim</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.arange(<span class="dv">10</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> np.arange(<span class="dv">6</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> np.arange(<span class="dv">4</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>o  <span class="op">=</span> [a1, a2, a3]</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>padded_o <span class="op">=</span> pad_sequences(o, maxlen<span class="op">=</span><span class="dv">4</span>, dtype<span class="op">=</span>np.float64, padding<span class="op">=</span><span class="st">'post'</span>, truncating<span class="op">=</span><span class="st">'pre'</span>, padding_value<span class="op">=</span>np.nan)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>test_eq(padded_o.shape, (<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>padded_o</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[  1.,   2.,   3.,   4.],
        [  6.,   7.,   8.,   9.]],

       [[  0.,  10.,  20.,  nan],
        [ 30.,  40.,  50.,  nan]],

       [[  0., 100.,  nan,  nan],
        [200., 300.,  nan,  nan]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 dim</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.arange(<span class="dv">10</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> np.arange(<span class="dv">6</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> np.arange(<span class="dv">4</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>o  <span class="op">=</span> [a1, a2, a3]</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>padded_o <span class="op">=</span> pad_sequences(o, maxlen<span class="op">=</span><span class="dv">4</span>, dtype<span class="op">=</span>np.float64, padding<span class="op">=</span><span class="st">'post'</span>, truncating<span class="op">=</span><span class="st">'post'</span>, padding_value<span class="op">=</span>np.nan)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>test_eq(padded_o.shape, (<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>padded_o</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[  0.,   1.,   2.,   3.],
        [  5.,   6.,   7.,   8.]],

       [[  0.,  10.,  20.,  nan],
        [ 30.,  40.,  50.,  nan]],

       [[  0., 100.,  nan,  nan],
        [200., 300.,  nan,  nan]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># iterable is a list of lists</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>a1 <span class="op">=</span> np.arange(<span class="dv">12</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>).tolist()</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>a2 <span class="op">=</span> (np.arange(<span class="dv">6</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="op">*</span> <span class="dv">10</span>).tolist()</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>a3 <span class="op">=</span> (np.arange(<span class="dv">4</span>).reshape(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span>).tolist()</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>o  <span class="op">=</span> [a1, a2, a3]</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>padded_o <span class="op">=</span> pad_sequences(o, maxlen<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span>np.float64, padding<span class="op">=</span><span class="st">'post'</span>, truncating<span class="op">=</span><span class="st">'pre'</span>, padding_value<span class="op">=</span>np.nan)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>test_eq(padded_o.shape, (<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">6</span>))</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>padded_o</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[  0.,   1.,   2.,   3.,   4.,   5.],
        [  6.,   7.,   8.,   9.,  10.,  11.]],

       [[  0.,  10.,  20.,  nan,  nan,  nan],
        [ 30.,  40.,  50.,  nan,  nan,  nan]],

       [[  0., 100.,  nan,  nan,  nan,  nan],
        [200., 300.,  nan,  nan,  nan,  nan]]])</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L400" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="match_seq_len" class="level3">
<h3 class="anchored" data-anchor-id="match_seq_len">match_seq_len</h3>
<blockquote class="blockquote">
<pre><code> match_seq_len (*arrays)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">8</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.rand(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>c, d <span class="op">=</span> match_seq_len(a, b)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>test_eq(c.shape[<span class="op">-</span><span class="dv">1</span>], d.shape[<span class="op">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L405" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_shuffle" class="level3">
<h3 class="anchored" data-anchor-id="random_shuffle">random_shuffle</h3>
<blockquote class="blockquote">
<pre><code> random_shuffle (o, random_state=None)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.arange(<span class="dv">10</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>test_eq_type(random_shuffle(a, <span class="dv">1</span>), np.array([<span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">5</span>]))</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.arange(<span class="dv">10</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>test_eq_type(random_shuffle(t, <span class="dv">1</span>), tensor([<span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">5</span>]))</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>l <span class="op">=</span> <span class="bu">list</span>(a)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>test_eq(random_shuffle(l, <span class="dv">1</span>), [<span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">5</span>])</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>l2 <span class="op">=</span> L(l)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>test_eq_type(random_shuffle(l2, <span class="dv">1</span>), L([<span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">5</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L412" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cat2int" class="level3">
<h3 class="anchored" data-anchor-id="cat2int">cat2int</h3>
<blockquote class="blockquote">
<pre><code> cat2int (o)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="st">'b'</span>, <span class="st">'a'</span>, <span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'a'</span>])</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>test_eq_type(cat2int(a), TensorCategory([<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>TensorBase([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>TensorBase([1, 2, 3])</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L439" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cycle_dl_estimate" class="level3">
<h3 class="anchored" data-anchor-id="cycle_dl_estimate">cycle_dl_estimate</h3>
<blockquote class="blockquote">
<pre><code> cycle_dl_estimate (dl, iters=10)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L430" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cycle_dl_to_device" class="level3">
<h3 class="anchored" data-anchor-id="cycle_dl_to_device">cycle_dl_to_device</h3>
<blockquote class="blockquote">
<pre><code> cycle_dl_to_device (dl, show_progress_bar=True)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L420" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cycle_dl" class="level3">
<h3 class="anchored" data-anchor-id="cycle_dl">cycle_dl</h3>
<blockquote class="blockquote">
<pre><code> cycle_dl (dl, show_progress_bar=True)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L451" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cache_data" class="level3">
<h3 class="anchored" data-anchor-id="cache_data">cache_data</h3>
<blockquote class="blockquote">
<pre><code> cache_data (o, slice_len=10000, verbose=False)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L466" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_func_defaults" class="level3">
<h3 class="anchored" data-anchor-id="get_func_defaults">get_func_defaults</h3>
<blockquote class="blockquote">
<pre><code> get_func_defaults (f)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L473" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_idx_from_df_col_vals" class="level3">
<h3 class="anchored" data-anchor-id="get_idx_from_df_col_vals">get_idx_from_df_col_vals</h3>
<blockquote class="blockquote">
<pre><code> get_idx_from_df_col_vals (df, col, val_list)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L477" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_sublist_idxs" class="level3">
<h3 class="anchored" data-anchor-id="get_sublist_idxs">get_sublist_idxs</h3>
<blockquote class="blockquote">
<pre><code> get_sublist_idxs (aList, bList)</code></pre>
</blockquote>
<p>Get idxs that when applied to aList will return bList. aList must contain all values in bList</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">2</span>])</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([<span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">7</span>])</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> get_sublist_idxs(x, y)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>test_eq(x[idx], y)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">2</span>])</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([<span class="dv">6</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">5</span>])</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> get_sublist_idxs(x, y)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>test_eq(x[idx], y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L483" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="flatten_list" class="level3">
<h3 class="anchored" data-anchor-id="flatten_list">flatten_list</h3>
<blockquote class="blockquote">
<pre><code> flatten_list (l)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L487" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="display_pd_df" class="level3">
<h3 class="anchored" data-anchor-id="display_pd_df">display_pd_df</h3>
<blockquote class="blockquote">
<pre><code> display_pd_df (df, max_rows:Union[bool,int]=False,
                max_columns:Union[bool,int]=False)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>old_max_rows, old_max_columns <span class="op">=</span> pd.get_option(<span class="st">'display.max_rows'</span>), pd.get_option(<span class="st">'display.max_columns'</span>)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.random.rand(<span class="dv">70</span>, <span class="dv">25</span>))</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>display_pd_df(df, max_rows<span class="op">=</span><span class="dv">2</span>, max_columns<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>test_eq(old_max_rows, pd.get_option(<span class="st">'display.max_rows'</span>))</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>test_eq(old_max_columns, pd.get_option(<span class="st">'display.max_columns'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>...</th>
      <th>24</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.074297</td>
      <td>...</td>
      <td>0.344860</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>69</th>
      <td>0.980740</td>
      <td>...</td>
      <td>0.141985</td>
    </tr>
  </tbody>
</table>
<p>70 rows × 25 columns</p>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L530" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="tscore" class="level3">
<h3 class="anchored" data-anchor-id="tscore">tscore</h3>
<blockquote class="blockquote">
<pre><code> tscore (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L506" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="kstest" class="level3">
<h3 class="anchored" data-anchor-id="kstest">kstest</h3>
<blockquote class="blockquote">
<pre><code> kstest (data1, data2, alternative='two-sided', mode='auto', by_axis=None)</code></pre>
</blockquote>
<p>Performs the two-sample Kolmogorov-Smirnov test for goodness of fit.</p>
<p>Parameters data1, data2: Two arrays of sample observations assumed to be drawn from a continuous distributions. Sample sizes can be different. alternative: {‘two-sided’, ‘less’, ‘greater’}, optional. Defines the null and alternative hypotheses. Default is ‘two-sided’. mode: {‘auto’, ‘exact’, ‘asymp’}, optional. Defines the method used for calculating the p-value. by_axis (optional, int): for arrays with more than 1 dimension, the test will be run for each variable in that axis if by_axis is not None.</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L501" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="ttest" class="level3">
<h3 class="anchored" data-anchor-id="ttest">ttest</h3>
<blockquote class="blockquote">
<pre><code> ttest (data1, data2, equal_var=False)</code></pre>
</blockquote>
<p>Calculates t-statistic and p-value based on 2 sample distributions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.normal(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.normal(<span class="fl">0.15</span>, <span class="fl">.5</span>, <span class="dv">50</span>)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>plt.hist(a, <span class="dv">50</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>plt.hist(b, <span class="dv">50</span>)</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>ttest(a,b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-96-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<pre><code>(1.1784111573186231, 0.2405408094645379)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.normal(<span class="fl">0.5</span>, <span class="dv">1</span>, (<span class="dv">100</span>,<span class="dv">3</span>))</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.normal(<span class="fl">0.5</span>, <span class="dv">1</span>, (<span class="dv">50</span>,))</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>kstest(a,b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(0.08333333333333333, 0.9110379107919119)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.normal(<span class="fl">0.5</span>, <span class="dv">1</span>, (<span class="dv">100</span>,<span class="dv">3</span>))</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.normal(<span class="fl">0.15</span>, <span class="fl">.5</span>, (<span class="dv">50</span>,))</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>kstest(a,b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(0.32, 0.00023099502310042208)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="op">=</span> np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>,(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">3</span>))</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> np.random.normal(<span class="dv">0</span>,<span class="dv">2</span>,(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">3</span>))</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>kstest(data1, data2, by_axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>([0.21666666666666667, 0.22333333333333333, 0.21, 0.16, 0.20666666666666667],
 [1.4007759411179028e-06,
  5.734627909208728e-07,
  3.3273813118952403e-06,
  0.0009055129810100997,
  5.0749555303276145e-06])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.normal(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.normal(<span class="fl">0.5</span>, <span class="dv">1</span>, (<span class="dv">100</span>, ))</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>tscore(a), tscore(t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(4.584959184776055, tensor(4.2273))</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L538" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="scc" class="level3">
<h3 class="anchored" data-anchor-id="scc">scc</h3>
<blockquote class="blockquote">
<pre><code> scc (a, b)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L535" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="pcc" class="level3">
<h3 class="anchored" data-anchor-id="pcc">pcc</h3>
<blockquote class="blockquote">
<pre><code> pcc (a, b)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L546" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="remove_fn" class="level3">
<h3 class="anchored" data-anchor-id="remove_fn">remove_fn</h3>
<blockquote class="blockquote">
<pre><code> remove_fn (fn, verbose=False)</code></pre>
</blockquote>
<p>Removes a file (fn) if exists</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L556" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="npsave" class="level3">
<h3 class="anchored" data-anchor-id="npsave">npsave</h3>
<blockquote class="blockquote">
<pre><code> npsave (array_fn, array, verbose=True)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>fn <span class="op">=</span> <span class="st">'data/remove_fn_test.npy'</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.zeros(<span class="dv">1</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>npsave(fn, a)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> a</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>np.load(fn, mmap_mode<span class="op">=</span><span class="st">'r+'</span>)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>remove_fn(fn, <span class="va">True</span>)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>remove_fn(fn, <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>data/remove_fn_test.npy does not exist
saving data/remove_fn_test.npy...
...data/remove_fn_test.npy saved
data/remove_fn_test.npy file removed
data/remove_fn_test.npy does not exist</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L565" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="permute_2d" class="level3">
<h3 class="anchored" data-anchor-id="permute_2d">permute_2D</h3>
<blockquote class="blockquote">
<pre><code> permute_2D (array, axis=None)</code></pre>
</blockquote>
<p>Permute rows or columns in an array. This can be used, for example, in feature permutation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> np.arange(<span class="dv">100</span> <span class="op">*</span> <span class="dv">50</span>).reshape(<span class="dv">100</span>, <span class="dv">50</span>) </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>test_eq(permute_2D(s, axis<span class="op">=</span><span class="dv">0</span>).mean(<span class="dv">0</span>), s.mean(<span class="dv">0</span>))</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>test_ne(permute_2D(s, axis<span class="op">=</span><span class="dv">0</span>), s)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>test_eq(permute_2D(s, axis<span class="op">=</span><span class="dv">1</span>).mean(<span class="dv">1</span>), s.mean(<span class="dv">1</span>))</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>test_ne(permute_2D(s, axis<span class="op">=</span><span class="dv">1</span>), s)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>test_ne(permute_2D(s), s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L590" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_half_normal_tensor" class="level3">
<h3 class="anchored" data-anchor-id="random_half_normal_tensor">random_half_normal_tensor</h3>
<blockquote class="blockquote">
<pre><code> random_half_normal_tensor (shape=1, device=None)</code></pre>
</blockquote>
<p>Returns a tensor of a predefined shape between 0 and 1 with a half-normal distribution</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L586" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_normal_tensor" class="level3">
<h3 class="anchored" data-anchor-id="random_normal_tensor">random_normal_tensor</h3>
<blockquote class="blockquote">
<pre><code> random_normal_tensor (shape=1, device=None)</code></pre>
</blockquote>
<p>Returns a tensor of a predefined shape between -1 and 1 with a normal distribution</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L579" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_half_normal" class="level3">
<h3 class="anchored" data-anchor-id="random_half_normal">random_half_normal</h3>
<blockquote class="blockquote">
<pre><code> random_half_normal ()</code></pre>
</blockquote>
<p>Returns a number between 0 and 1 with a half-normal distribution</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L572" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_normal" class="level3">
<h3 class="anchored" data-anchor-id="random_normal">random_normal</h3>
<blockquote class="blockquote">
<pre><code> random_normal ()</code></pre>
</blockquote>
<p>Returns a number between -1 and 1 with a normal distribution</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L615" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="fig2buf" class="level3">
<h3 class="anchored" data-anchor-id="fig2buf">fig2buf</h3>
<blockquote class="blockquote">
<pre><code> fig2buf (fig)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L602" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_plot_fig" class="level3">
<h3 class="anchored" data-anchor-id="get_plot_fig">get_plot_fig</h3>
<blockquote class="blockquote">
<pre><code> get_plot_fig (size=None, dpi=100)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L597" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="default_dpi" class="level3">
<h3 class="anchored" data-anchor-id="default_dpi">default_dpi</h3>
<blockquote class="blockquote">
<pre><code> default_dpi ()</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>default_dpi()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>100</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L621" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_scatter" class="level3">
<h3 class="anchored" data-anchor-id="plot_scatter">plot_scatter</h3>
<blockquote class="blockquote">
<pre><code> plot_scatter (x, y, deg=1)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">100</span>)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.rand(<span class="dv">100</span>)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>plot_scatter(a, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-117-output-1.png" class="img-fluid"></p>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L629" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_idxs" class="level3">
<h3 class="anchored" data-anchor-id="get_idxs">get_idxs</h3>
<blockquote class="blockquote">
<pre><code> get_idxs (o, aList)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> random_shuffle(np.arange(<span class="dv">100</span>, <span class="dv">200</span>))</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.choice(a, <span class="dv">10</span>, <span class="va">False</span>)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>idxs <span class="op">=</span> get_idxs(a, b)</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>test_eq(a[idxs], b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L632" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="apply_cmap" class="level3">
<h3 class="anchored" data-anchor-id="apply_cmap">apply_cmap</h3>
<blockquote class="blockquote">
<pre><code> apply_cmap (o, cmap)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">40</span>, <span class="dv">50</span>)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> L(a.shape)</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>s[<span class="dv">1</span>] <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>test_eq(L(apply_cmap(a, <span class="st">'viridis'</span>).shape), s)</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>s[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">1</span>, <span class="dv">40</span>, <span class="dv">50</span>)</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>test_eq(L(apply_cmap(a, <span class="st">'viridis'</span>).shape), s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L639" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_tile" class="level3">
<h3 class="anchored" data-anchor-id="torch_tile">torch_tile</h3>
<blockquote class="blockquote">
<pre><code> torch_tile (a, n_tile, dim=0)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>test_eq(torch_tile(torch.arange(<span class="dv">2</span>), <span class="dv">3</span>), tensor([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L652" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to_tsfresh_df" class="level3">
<h3 class="anchored" data-anchor-id="to_tsfresh_df">to_tsfresh_df</h3>
<blockquote class="blockquote">
<pre><code> to_tsfresh_df (ts)</code></pre>
</blockquote>
<p>Prepares a time series (Tensor/ np.ndarray) to be used as a tsfresh dataset to allow feature extraction</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>ts <span class="op">=</span> torch.rand(<span class="dv">16</span>, <span class="dv">3</span>, <span class="dv">20</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> to_tsfresh_df(ts)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>ts <span class="op">=</span> ts.numpy()</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> to_tsfresh_df(ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L673" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="scorr" class="level3">
<h3 class="anchored" data-anchor-id="scorr">scorr</h3>
<blockquote class="blockquote">
<pre><code> scorr (a, b)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L670" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="pcorr" class="level3">
<h3 class="anchored" data-anchor-id="pcorr">pcorr</h3>
<blockquote class="blockquote">
<pre><code> pcorr (a, b)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L678" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_diff" class="level3">
<h3 class="anchored" data-anchor-id="torch_diff">torch_diff</h3>
<blockquote class="blockquote">
<pre><code> torch_diff (t, lag=1, pad=True, append=0)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.arange(<span class="dv">24</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>test_eq(torch_diff(t, <span class="dv">1</span>)[..., <span class="dv">1</span>:].<span class="bu">float</span>().mean(), <span class="fl">1.</span>)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>test_eq(torch_diff(t, <span class="dv">2</span>)[..., <span class="dv">2</span>:].<span class="bu">float</span>().mean(), <span class="fl">2.</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L710" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_clamp" class="level3">
<h3 class="anchored" data-anchor-id="torch_clamp">torch_clamp</h3>
<blockquote class="blockquote">
<pre><code> torch_clamp (o, min=None, max=None)</code></pre>
</blockquote>
<p>Clamp torch.Tensor using 1 or multiple dimensions</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L704" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_percentile" class="level3">
<h3 class="anchored" data-anchor-id="get_percentile">get_percentile</h3>
<blockquote class="blockquote">
<pre><code> get_percentile (o, percentile, axis=None)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L697" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="clip_outliers" class="level3">
<h3 class="anchored" data-anchor-id="clip_outliers">clip_outliers</h3>
<blockquote class="blockquote">
<pre><code> clip_outliers (o, axis=None)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L687" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_outliers_iqr" class="level3">
<h3 class="anchored" data-anchor-id="get_outliers_iqr">get_outliers_IQR</h3>
<blockquote class="blockquote">
<pre><code> get_outliers_IQR (o, axis=None, quantile_range=(25.0, 75.0))</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.randn(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">100</span>)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">type</span>(get_outliers_IQR(t, <span class="op">-</span><span class="dv">1</span>)[<span class="dv">0</span>]), torch.Tensor)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> t.numpy()</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">type</span>(get_outliers_IQR(a, <span class="op">-</span><span class="dv">1</span>)[<span class="dv">0</span>]), np.ndarray)</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>test_close(get_percentile(t, <span class="dv">25</span>).numpy(), get_percentile(a, <span class="dv">25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L717" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_robustscale_params" class="level3">
<h3 class="anchored" data-anchor-id="get_robustscale_params">get_robustscale_params</h3>
<blockquote class="blockquote">
<pre><code> get_robustscale_params (o, sel_vars=None, not_sel_vars=None, by_var=True,
                         percentiles=(25, 75), eps=1e-06)</code></pre>
</blockquote>
<p>Calculates median and inter-quartile range required to robust scaler inputs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">16</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>a[a<span class="op">&gt;</span><span class="fl">.8</span>] <span class="op">=</span> np.nan</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>median, IQR <span class="op">=</span> get_robustscale_params(a, by_var<span class="op">=</span><span class="va">True</span>, percentiles<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">75</span>))</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>a_scaled <span class="op">=</span> (a <span class="op">-</span> median) <span class="op">/</span> IQR</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>test_eq(a.shape, a_scaled.shape)</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>test_eq(np.isnan(median).<span class="bu">sum</span>(),<span class="dv">0</span>)</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>test_eq(np.isnan(IQR).<span class="bu">sum</span>(),<span class="dv">0</span>)</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>test_eq(np.isnan(a), np.isnan(a_scaled))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L745" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_slice_by_dim" class="level3">
<h3 class="anchored" data-anchor-id="torch_slice_by_dim">torch_slice_by_dim</h3>
<blockquote class="blockquote">
<pre><code> torch_slice_by_dim (t, index, dim=-1, **kwargs)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.rand(<span class="dv">5</span>, <span class="dv">3</span>)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> torch.randint(<span class="dv">0</span>, <span class="dv">3</span>, (<span class="dv">5</span>, <span class="dv">1</span>))</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="co"># index = [[0, 2], [0, 1], [1, 2], [0, 2], [0, 1]]</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>torch_slice_by_dim(t, index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>tensor([[0.2770],
        [0.4482],
        [0.7977],
        [0.9300],
        [0.5764]])</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L764" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_nanstd" class="level3">
<h3 class="anchored" data-anchor-id="torch_nanstd">torch_nanstd</h3>
<blockquote class="blockquote">
<pre><code> torch_nanstd (o, dim=None, keepdim=False)</code></pre>
</blockquote>
<p>There’s currently no torch.nanstd function</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L752" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_nanmean" class="level3">
<h3 class="anchored" data-anchor-id="torch_nanmean">torch_nanmean</h3>
<blockquote class="blockquote">
<pre><code> torch_nanmean (o, dim=None, keepdim=False)</code></pre>
</blockquote>
<p>There’s currently no torch.nanmean function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.rand(<span class="dv">1000</span>)</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>t[:<span class="dv">100</span>] <span class="op">=</span> <span class="bu">float</span>(<span class="st">'nan'</span>)</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> torch_nanmean(t).item() <span class="op">&gt;</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L776" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="concat" class="level3">
<h3 class="anchored" data-anchor-id="concat">concat</h3>
<blockquote class="blockquote">
<pre><code> concat (*ls, dim=0)</code></pre>
</blockquote>
<p>Concatenate tensors, arrays, lists, or tuples by a dimension</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L787" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="reduce_memory_usage" class="level3">
<h3 class="anchored" data-anchor-id="reduce_memory_usage">reduce_memory_usage</h3>
<blockquote class="blockquote">
<pre><code> reduce_memory_usage (df)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L825" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cls_name" class="level3">
<h3 class="anchored" data-anchor-id="cls_name">cls_name</h3>
<blockquote class="blockquote">
<pre><code> cls_name (o)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>test_eq(cls_name(timer), <span class="st">'Timer'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L898" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="rotate_axis2" class="level3">
<h3 class="anchored" data-anchor-id="rotate_axis2">rotate_axis2</h3>
<blockquote class="blockquote">
<pre><code> rotate_axis2 (o, steps=1)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L895" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="rotate_axis1" class="level3">
<h3 class="anchored" data-anchor-id="rotate_axis1">rotate_axis1</h3>
<blockquote class="blockquote">
<pre><code> rotate_axis1 (o, steps=1)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L892" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="rotate_axis0" class="level3">
<h3 class="anchored" data-anchor-id="rotate_axis0">rotate_axis0</h3>
<blockquote class="blockquote">
<pre><code> rotate_axis0 (o, steps=1)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L877" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_roll3d" class="level3">
<h3 class="anchored" data-anchor-id="random_roll3d">random_roll3d</h3>
<blockquote class="blockquote">
<pre><code> random_roll3d (o, axis=(), replace=False)</code></pre>
</blockquote>
<p>Randomly rolls a 3D object along the indicated axes This solution is based on https://stackoverflow.com/questions/20360675/roll-rows-of-a-matrix-independently</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L863" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="random_roll2d" class="level3">
<h3 class="anchored" data-anchor-id="random_roll2d">random_roll2d</h3>
<blockquote class="blockquote">
<pre><code> random_roll2d (o, axis=(), replace=False)</code></pre>
</blockquote>
<p>Rolls a 2D object on the indicated axis This solution is based on https://stackoverflow.com/questions/20360675/roll-rows-of-a-matrix-independently</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L844" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="roll3d" class="level3">
<h3 class="anchored" data-anchor-id="roll3d">roll3d</h3>
<blockquote class="blockquote">
<pre><code> roll3d (o, roll1:Union[NoneType,list,int]=None,
         roll2:Union[NoneType,list,int]=None,
         roll3:Union[NoneType,list,int]=None)</code></pre>
</blockquote>
<p>Rolls a 3D object on the indicated axis This solution is based on https://stackoverflow.com/questions/20360675/roll-rows-of-a-matrix-independently</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L828" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="roll2d" class="level3">
<h3 class="anchored" data-anchor-id="roll2d">roll2d</h3>
<blockquote class="blockquote">
<pre><code> roll2d (o, roll1:Union[NoneType,list,int]=None,
         roll2:Union[NoneType,list,int]=None)</code></pre>
</blockquote>
<p>Rolls a 2D object on the indicated axis This solution is based on https://stackoverflow.com/questions/20360675/roll-rows-of-a-matrix-independently</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.tile(np.arange(<span class="dv">10</span>), <span class="dv">3</span>).reshape(<span class="dv">3</span>, <span class="dv">10</span>) <span class="op">*</span> np.array([<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>]).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[  0,   1,   2,   3,   4,   5,   6,   7,   8,   9],
       [  0,  10,  20,  30,  40,  50,  60,  70,  80,  90],
       [  0, 100, 200, 300, 400, 500, 600, 700, 800, 900]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>roll2d(a, roll1<span class="op">=</span>[<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[  0, 100, 200, 300, 400, 500, 600, 700, 800, 900],
       [  0,  10,  20,  30,  40,  50,  60,  70,  80,  90],
       [  0,   1,   2,   3,   4,   5,   6,   7,   8,   9]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>roll2d(a, roll2<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[  7,   8,   9,   0,   1,   2,   3,   4,   5,   6],
       [ 70,  80,  90,   0,  10,  20,  30,  40,  50,  60],
       [700, 800, 900,   0, 100, 200, 300, 400, 500, 600]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> torch.arange(<span class="dv">24</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>test_eq(rotate_axis0(o)[<span class="dv">1</span>], o[<span class="dv">0</span>])</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>test_eq(rotate_axis1(o)[:,<span class="dv">1</span>], o[:,<span class="dv">0</span>])</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>test_eq(rotate_axis2(o)[...,<span class="dv">1</span>], o[...,<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L902" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="chunks_calculator" class="level3">
<h3 class="anchored" data-anchor-id="chunks_calculator">chunks_calculator</h3>
<blockquote class="blockquote">
<pre><code> chunks_calculator (shape, dtype='float32', n_bytes=1073741824)</code></pre>
</blockquote>
<p>Function to calculate chunks for a given size of n_bytes (default = 1024**3 == 1GB). It guarantees &gt; 50% of the chunk will be filled</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>shape <span class="op">=</span> (<span class="dv">1_000</span>, <span class="dv">10</span>, <span class="dv">1000</span>)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>dtype <span class="op">=</span> <span class="st">'float32'</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>test_eq(chunks_calculator(shape, dtype), <span class="va">False</span>)</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>shape <span class="op">=</span> (<span class="dv">54684</span>, <span class="dv">10</span>, <span class="dv">1000</span>)</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>dtype <span class="op">=</span> <span class="st">'float32'</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>test_eq(chunks_calculator(shape, dtype), (<span class="dv">27342</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L917" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="is_memory_shared" class="level3">
<h3 class="anchored" data-anchor-id="is_memory_shared">is_memory_shared</h3>
<blockquote class="blockquote">
<pre><code> is_memory_shared (a, b)</code></pre>
</blockquote>
<p>Check if 2 array-like objects share memory</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> torch.from_numpy(a)</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>test_eq(is_memory_shared(a, t1), <span class="va">True</span>)</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> torch.as_tensor(a)</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>test_eq(is_memory_shared(a, t2), <span class="va">True</span>)</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>t3 <span class="op">=</span> torch.tensor(a)</span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>test_eq(is_memory_shared(a, t3), <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L923" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="assign_in_chunks" class="level3">
<h3 class="anchored" data-anchor-id="assign_in_chunks">assign_in_chunks</h3>
<blockquote class="blockquote">
<pre><code> assign_in_chunks (a, b, chunksize='auto', inplace=True, verbose=True)</code></pre>
</blockquote>
<p>Assigns values in b to an array-like object a using chunks to avoid memory overload. The resulting a retains it’s dtype and share it’s memory. a: array-like object b: may be an integer, float, str, ‘rand’ (for random data), or another array like object. chunksize: is the size of chunks. If ‘auto’ chunks will have around 1GB each.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>a_dtype <span class="op">=</span> a.dtype</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>a_id <span class="op">=</span> <span class="bu">id</span>(a)</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float64'</span>)</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">True</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>test_close(a, b)</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, a_dtype)</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">id</span>(a), a_id)</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>a_dtype <span class="op">=</span> a.dtype</span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a>a_id <span class="op">=</span> <span class="bu">id</span>(a)</span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">True</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a>test_eq(a, np.ones_like(a).astype(a.dtype))</span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, a_dtype)</span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">id</span>(a), a_id)</span>
<span id="cb185-18"><a href="#cb185-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-19"><a href="#cb185-19" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb185-20"><a href="#cb185-20" aria-hidden="true" tabindex="-1"></a>a_dtype <span class="op">=</span> a.dtype</span>
<span id="cb185-21"><a href="#cb185-21" aria-hidden="true" tabindex="-1"></a>a_id <span class="op">=</span> <span class="bu">id</span>(a)</span>
<span id="cb185-22"><a href="#cb185-22" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb185-23"><a href="#cb185-23" aria-hidden="true" tabindex="-1"></a>assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">True</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb185-24"><a href="#cb185-24" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, a_dtype)</span>
<span id="cb185-25"><a href="#cb185-25" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">id</span>(a), a_id)</span>
<span id="cb185-26"><a href="#cb185-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-27"><a href="#cb185-27" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb185-28"><a href="#cb185-28" aria-hidden="true" tabindex="-1"></a>a_dtype <span class="op">=</span> a.dtype</span>
<span id="cb185-29"><a href="#cb185-29" aria-hidden="true" tabindex="-1"></a>a_id <span class="op">=</span> <span class="bu">id</span>(a)</span>
<span id="cb185-30"><a href="#cb185-30" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="st">'rand'</span></span>
<span id="cb185-31"><a href="#cb185-31" aria-hidden="true" tabindex="-1"></a>assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">True</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb185-32"><a href="#cb185-32" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, a_dtype)</span>
<span id="cb185-33"><a href="#cb185-33" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">id</span>(a), a_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float64'</span>)</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">False</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>test_close(c, b)</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, c.dtype)</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>test_eq(is_memory_shared(a, c), <span class="va">True</span>)</span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">False</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a>test_eq(a, np.ones_like(a).astype(a.dtype))</span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, c.dtype)</span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a>test_eq(is_memory_shared(a, c), <span class="va">True</span>)</span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb186-17"><a href="#cb186-17" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">False</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb186-18"><a href="#cb186-18" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, c.dtype)</span>
<span id="cb186-19"><a href="#cb186-19" aria-hidden="true" tabindex="-1"></a>test_eq(is_memory_shared(a, c), <span class="va">True</span>)</span>
<span id="cb186-20"><a href="#cb186-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-21"><a href="#cb186-21" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">4</span>).astype(<span class="st">'float32'</span>)</span>
<span id="cb186-22"><a href="#cb186-22" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="st">'rand'</span></span>
<span id="cb186-23"><a href="#cb186-23" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> assign_in_chunks(a, b, chunksize<span class="op">=</span><span class="dv">2</span>, inplace<span class="op">=</span><span class="va">False</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb186-24"><a href="#cb186-24" aria-hidden="true" tabindex="-1"></a>test_eq(a.dtype, c.dtype)</span>
<span id="cb186-25"><a href="#cb186-25" aria-hidden="true" tabindex="-1"></a>test_eq(is_memory_shared(a, c), <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L954" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="create_array" class="level3">
<h3 class="anchored" data-anchor-id="create_array">create_array</h3>
<blockquote class="blockquote">
<pre><code> create_array (shape, fname=None, path='./data', on_disk=True,
               dtype='float32', mode='r+', fill_value='rand',
               chunksize='auto', verbose=True, **kwargs)</code></pre>
</blockquote>
<p>mode: ‘r’: Open existing file for reading only. ‘r+’: Open existing file for reading and writing. ‘w+’: Create or overwrite existing file for reading and writing. ‘c’: Copy-on-write: assignments affect data in memory, but changes are not saved to disk. The file on disk is read-only. fill_value: ‘rand’ (for random numbers), int or float chunksize = ‘auto’ to calculate chunks of 1GB, or any integer (for a given number of samples)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">'X_on_disk'</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>shape <span class="op">=</span> (<span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> create_array(shape, fname, on_disk<span class="op">=</span><span class="va">True</span>, mode<span class="op">=</span><span class="st">'r+'</span>)</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>test_ne(<span class="bu">abs</span>(X).<span class="bu">sum</span>(), <span class="dv">0</span>)</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>os.remove(X.filename)</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>auto chunksize: 100</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">'X_on_disk'</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>shape <span class="op">=</span> (<span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> create_empty_array(shape, fname, on_disk<span class="op">=</span><span class="va">True</span>, mode<span class="op">=</span><span class="st">'r+'</span>)</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">abs</span>(X).<span class="bu">sum</span>(), <span class="dv">0</span>)</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>chunksize <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>pbar <span class="op">=</span> progress_bar(<span class="bu">range</span>(math.ceil(<span class="bu">len</span>(X) <span class="op">/</span> chunksize)), leave<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> pbar: </span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>    end <span class="op">=</span> <span class="bu">min</span>(start <span class="op">+</span> chunksize, <span class="bu">len</span>(X))</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>    partial_data <span class="op">=</span> np.random.rand(end <span class="op">-</span> start, X.shape[<span class="dv">1</span>] , X.shape[<span class="dv">2</span>])</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>    X[start:end] <span class="op">=</span> partial_data</span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> end</span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> partial_data</span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a>    gc.collect()</span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>filename <span class="op">=</span> X.filename</span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> X</span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.load(filename, mmap_mode<span class="op">=</span><span class="st">'r+'</span>)</span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a>test_eq((X <span class="op">==</span> <span class="dv">0</span>).<span class="bu">sum</span>(), <span class="dv">0</span>)</span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a>test_eq(X.shape, shape)</span>
<span id="cb190-21"><a href="#cb190-21" aria-hidden="true" tabindex="-1"></a>os.remove(X.filename)</span>
<span id="cb190-22"><a href="#cb190-22" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1002" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="np_load_compressed" class="level3">
<h3 class="anchored" data-anchor-id="np_load_compressed">np_load_compressed</h3>
<blockquote class="blockquote">
<pre><code> np_load_compressed (fname=None, path='./data', **kwargs)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L991" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="np_save_compressed" class="level3">
<h3 class="anchored" data-anchor-id="np_save_compressed">np_save_compressed</h3>
<blockquote class="blockquote">
<pre><code> np_save_compressed (arr, fname=None, path='./data', verbose=False,
                     **kwargs)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>X1 <span class="op">=</span> np.random.rand(<span class="dv">10</span>)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>np_save_compressed(X1, <span class="st">'X_comp'</span>, path<span class="op">=</span><span class="st">'./data'</span>)</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>X2 <span class="op">=</span> np_load_compressed(<span class="st">'X_comp'</span>)</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>test_eq(X1, X2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1013" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="np2memmap" class="level3">
<h3 class="anchored" data-anchor-id="np2memmap">np2memmap</h3>
<blockquote class="blockquote">
<pre><code> np2memmap (arr, fname=None, path='./data', dtype='float32', mode='c',
            **kwargs)</code></pre>
</blockquote>
<p>Function that turns an ndarray into a memmap ndarray mode: ‘r’: Open existing file for reading only. ‘r+’: Open existing file for reading and writing. ‘w+’: Create or overwrite existing file for reading and writing. ‘c’: Copy-on-write: assignments affect data in memory, but changes are not saved to disk. The file on disk is read-only.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>X1 <span class="op">=</span> np.random.rand(<span class="dv">10</span>)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>X2 <span class="op">=</span> np2memmap(X1, <span class="st">'X1_test'</span>)</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>test_eq(X1, X2)</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>test_ne(<span class="bu">type</span>(X1), <span class="bu">type</span>(X2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1032" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_mean_groupby" class="level3">
<h3 class="anchored" data-anchor-id="torch_mean_groupby">torch_mean_groupby</h3>
<blockquote class="blockquote">
<pre><code> torch_mean_groupby (o, idxs)</code></pre>
</blockquote>
<p>Computes torch mean along axis 0 grouped by the idxs. Need to ensure that idxs have the same order as o</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> torch.arange(<span class="dv">6</span><span class="op">*</span><span class="dv">2</span><span class="op">*</span><span class="dv">3</span>).reshape(<span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">3</span>).<span class="bu">float</span>()</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>idxs <span class="op">=</span> np.array([[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>], [<span class="dv">2</span>,<span class="dv">3</span>]], dtype<span class="op">=</span><span class="bu">object</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>output <span class="op">=</span> torch_mean_groupby(o, idxs)</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>test_eq(o[:<span class="dv">2</span>], output[:<span class="dv">2</span>])</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>test_eq(o[<span class="dv">2</span>:<span class="dv">4</span>].mean(<span class="dv">0</span>), output[<span class="dv">2</span>])</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>test_eq(o[<span class="dv">4</span>:<span class="dv">6</span>].mean(<span class="dv">0</span>), output[<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1042" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_flip" class="level3">
<h3 class="anchored" data-anchor-id="torch_flip">torch_flip</h3>
<blockquote class="blockquote">
<pre><code> torch_flip (t, dims=-1)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.randn(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>test_eq(torch.flip(t, (<span class="dv">2</span>,)), torch_flip(t, dims<span class="op">=-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1055" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_masked_to_num" class="level3">
<h3 class="anchored" data-anchor-id="torch_masked_to_num">torch_masked_to_num</h3>
<blockquote class="blockquote">
<pre><code> torch_masked_to_num (o, mask, num=0, inplace=False)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1049" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="torch_nan_to_num" class="level3">
<h3 class="anchored" data-anchor-id="torch_nan_to_num">torch_nan_to_num</h3>
<blockquote class="blockquote">
<pre><code> torch_nan_to_num (o, num=0, inplace=False)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> torch.rand(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>x[:, :<span class="dv">3</span>][x[:, :<span class="dv">3</span>] <span class="op">&lt;</span> <span class="fl">.5</span>] <span class="op">=</span> np.nan</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>nan_values <span class="op">=</span> torch.isnan(x).<span class="bu">sum</span>()</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> torch_nan_to_num(x[:, :<span class="dv">3</span>], inplace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>test_eq(torch.isnan(y).<span class="bu">sum</span>(), <span class="dv">0</span>)</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>test_eq(torch.isnan(x).<span class="bu">sum</span>(), nan_values)</span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>torch_nan_to_num(x[:, :<span class="dv">3</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>test_eq(torch.isnan(x).<span class="bu">sum</span>(), <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> torch.rand(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> x[:, :<span class="dv">3</span>] <span class="op">&gt;</span> <span class="fl">.5</span></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>x[:, :<span class="dv">3</span>] <span class="op">=</span> torch_masked_to_num(x[:, :<span class="dv">3</span>], mask, num<span class="op">=</span><span class="dv">0</span>, inplace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>test_eq(x[:, :<span class="dv">3</span>][mask].<span class="bu">sum</span>(), <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> torch.rand(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> x[:, :<span class="dv">3</span>] <span class="op">&gt;</span> <span class="fl">.5</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>torch_masked_to_num(x[:, :<span class="dv">3</span>], mask, num<span class="op">=</span><span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>test_eq(x[:, :<span class="dv">3</span>][mask].<span class="bu">sum</span>(), <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1062" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="mpl_trend" class="level3">
<h3 class="anchored" data-anchor-id="mpl_trend">mpl_trend</h3>
<blockquote class="blockquote">
<pre><code> mpl_trend (x, y, deg=1)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.sort(np.random.randint(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">100</span>)<span class="op">/</span><span class="dv">10</span>)</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.random.rand(<span class="dv">100</span>) <span class="op">+</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>trend <span class="op">=</span> mpl_trend(x, y)</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, y)</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>plt.plot(x, trend, <span class="st">'r'</span>)</span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-182-output-1.png" class="img-fluid"></p>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1078" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="array2digits" class="level3">
<h3 class="anchored" data-anchor-id="array2digits">array2digits</h3>
<blockquote class="blockquote">
<pre><code> array2digits (o, n_digits=None, normalize=True)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1066" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="int2digits" class="level3">
<h3 class="anchored" data-anchor-id="int2digits">int2digits</h3>
<blockquote class="blockquote">
<pre><code> int2digits (o, n_digits=None, normalize=True)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> <span class="op">-</span><span class="dv">9645</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>test_eq(int2digits(o, <span class="dv">6</span>), np.array([ <span class="dv">0</span>,  <span class="dv">0</span>, <span class="op">-</span><span class="fl">.9</span>, <span class="op">-</span><span class="fl">.6</span>, <span class="op">-</span><span class="fl">.4</span>, <span class="op">-</span><span class="fl">.5</span>]))</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.randint(<span class="op">-</span><span class="dv">1000</span>, <span class="dv">1000</span>, <span class="dv">10</span>)</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>test_eq(array2digits(a,<span class="dv">5</span>).shape, (<span class="dv">10</span>,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1085" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="sincos_encoding" class="level3">
<h3 class="anchored" data-anchor-id="sincos_encoding">sincos_encoding</h3>
<blockquote class="blockquote">
<pre><code> sincos_encoding (seq_len, device=None, to_np=False)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>sin, cos <span class="op">=</span> sincos_encoding(<span class="dv">100</span>)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>plt.plot(sin.cpu().numpy())</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>plt.plot(cos.cpu().numpy())</span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-187-output-1.png" class="img-fluid"></p>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1096" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="linear_encoding" class="level3">
<h3 class="anchored" data-anchor-id="linear_encoding">linear_encoding</h3>
<blockquote class="blockquote">
<pre><code> linear_encoding (seq_len, device=None, to_np=False, lin_range=(-1, 1))</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>lin <span class="op">=</span> linear_encoding(<span class="dv">100</span>)</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>plt.plot(lin.cpu().numpy())</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-189-output-1.png" class="img-fluid"></p>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1105" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="encode_positions" class="level3">
<h3 class="anchored" data-anchor-id="encode_positions">encode_positions</h3>
<blockquote class="blockquote">
<pre><code> encode_positions (pos_arr, min_val=None, max_val=None, linear=False,
                   lin_range=(-1, 1))</code></pre>
</blockquote>
<p>Encodes an array with positions using a linear or sincos methods</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>_a <span class="op">=</span> []</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_samples):</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">4000</span>, <span class="dv">4000</span>, <span class="dv">10</span>)</span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> np.random.rand(<span class="bu">len</span>(a)) <span class="op">&gt;</span> <span class="fl">.5</span></span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> a[mask]</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> np.concatenate([a, np.array([np.nan] <span class="op">*</span> (length <span class="op">-</span> <span class="bu">len</span>(a)))])</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>    _a.append(a.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.concatenate(_a, <span class="op">-</span><span class="dv">1</span>).transpose(<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a>sin, cos <span class="op">=</span> encode_positions(a, linear<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a>test_eq(a.shape, (n_samples, length))</span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a>test_eq(sin.shape, (n_samples, length))</span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a>test_eq(cos.shape, (n_samples, length))</span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a>plt.plot(sin.T)</span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true" tabindex="-1"></a>plt.plot(cos.T)</span>
<span id="cb215-17"><a href="#cb215-17" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>, <span class="dv">500</span>)</span>
<span id="cb215-18"><a href="#cb215-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-191-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>_a <span class="op">=</span> []</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_samples):</span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">4000</span>, <span class="dv">4000</span>, <span class="dv">10</span>)</span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> np.random.rand(<span class="bu">len</span>(a)) <span class="op">&gt;</span> <span class="fl">.5</span></span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> a[mask]</span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> np.concatenate([a, np.array([np.nan] <span class="op">*</span> (length <span class="op">-</span> <span class="bu">len</span>(a)))])</span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a>    _a.append(a.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.concatenate(_a, <span class="op">-</span><span class="dv">1</span>).transpose(<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true" tabindex="-1"></a>lin <span class="op">=</span> encode_positions(a, linear<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb216-12"><a href="#cb216-12" aria-hidden="true" tabindex="-1"></a>test_eq(a.shape, (n_samples, length))</span>
<span id="cb216-13"><a href="#cb216-13" aria-hidden="true" tabindex="-1"></a>test_eq(lin.shape, (n_samples, length))</span>
<span id="cb216-14"><a href="#cb216-14" aria-hidden="true" tabindex="-1"></a>plt.plot(lin.T)</span>
<span id="cb216-15"><a href="#cb216-15" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>, <span class="dv">500</span>)</span>
<span id="cb216-16"><a href="#cb216-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-192-output-1.png" class="img-fluid"></p>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1122" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="sort_generator" class="level3">
<h3 class="anchored" data-anchor-id="sort_generator">sort_generator</h3>
<blockquote class="blockquote">
<pre><code> sort_generator (generator, bs)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>generator <span class="op">=</span> (i <span class="cf">for</span> i <span class="kw">in</span> np.random.permutation(np.arange(<span class="dv">1000000</span>)).tolist())</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>l <span class="op">=</span> <span class="bu">list</span>(sort_generator(generator, <span class="dv">512</span>))</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>test_eq(l[:<span class="dv">512</span>], <span class="bu">sorted</span>(l[:<span class="dv">512</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1128" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_subset_dict" class="level3">
<h3 class="anchored" data-anchor-id="get_subset_dict">get_subset_dict</h3>
<blockquote class="blockquote">
<pre><code> get_subset_dict (d, keys)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>keys <span class="op">=</span> string.ascii_lowercase</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> np.arange(<span class="bu">len</span>(keys))</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> {k:v <span class="cf">for</span> k,v <span class="kw">in</span> <span class="bu">zip</span>(keys,values)}</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>test_eq(get_subset_dict(d, [<span class="st">'a'</span>, <span class="st">'k'</span>, <span class="st">'j'</span>, <span class="st">'e'</span>]), {<span class="st">'a'</span>: <span class="dv">0</span>, <span class="st">'k'</span>: <span class="dv">10</span>, <span class="st">'j'</span>: <span class="dv">9</span>, <span class="st">'e'</span>: <span class="dv">4</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1144" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="remove_dir" class="level3">
<h3 class="anchored" data-anchor-id="remove_dir">remove_dir</h3>
<blockquote class="blockquote">
<pre><code> remove_dir (directory, verbose=True)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1132" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="create_dir" class="level3">
<h3 class="anchored" data-anchor-id="create_dir">create_dir</h3>
<blockquote class="blockquote">
<pre><code> create_dir (directory, verbose=True)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">"wandb3/wandb2/wandb"</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>create_dir(path)</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> Path(path).exists()</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>paths <span class="op">=</span> [<span class="st">"wandb3/wandb2/wandb"</span>, <span class="st">"wandb3/wandb2"</span>, <span class="st">"wandb"</span>]</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>remove_dir(paths)</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> paths: </span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> <span class="kw">not</span> Path(p).exists()</span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">"wandb3"</span></span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> Path(path).exists()</span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a>remove_dir(path)</span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="kw">not</span> Path(path).exists()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>wandb3/wandb2/wandb directory created.
wandb3/wandb2/wandb directory removed.
wandb3/wandb2 directory removed.
wandb directory doesn't exist.
wandb3 directory removed.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>create_dir(<span class="st">'./test'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>test directory created.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fn(b): <span class="cf">return</span> a <span class="op">+</span> b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Writing ./test/mod_dev.py</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">"./test/mod_dev.py"</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>: </span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> fname[<span class="dv">0</span>] <span class="kw">in</span> <span class="st">"/ ."</span>: fname <span class="op">=</span> fname.split(fname[<span class="dv">0</span>], <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: <span class="cf">break</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'/'</span> <span class="kw">in</span> fname <span class="kw">and</span> fname.rsplit(<span class="st">'/'</span>, <span class="dv">1</span>)[<span class="dv">0</span>] <span class="kw">not</span> <span class="kw">in</span> sys.path: sys.path.append(fname.rsplit(<span class="st">'/'</span>, <span class="dv">1</span>)[<span class="dv">0</span>])</span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>mod <span class="op">=</span> import_file_as_module(fname)</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>test_eq(mod.fn(<span class="dv">3</span>), <span class="dv">8</span>)</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>sys.path <span class="op">=</span> sys.path[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>remove_dir(<span class="st">'./test/'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>test directory removed.</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1158" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="named_partial" class="level3">
<h3 class="anchored" data-anchor-id="named_partial">named_partial</h3>
<blockquote class="blockquote">
<pre><code> named_partial (name, func, *args, **kwargs)</code></pre>
</blockquote>
<p>Create a partial function with a <strong>name</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_1(x, add<span class="op">=</span><span class="dv">1</span>): <span class="cf">return</span> x<span class="op">+</span>add</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>test_eq(add_1(<span class="dv">1</span>), <span class="dv">2</span>)</span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>add_2 <span class="op">=</span> partial(add_1, add<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>test_eq(add_2(<span class="dv">2</span>), <span class="dv">4</span>)</span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>test_ne(<span class="bu">str</span>(add_2), <span class="st">"add_2"</span>)</span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>add_2 <span class="op">=</span> named_partial(<span class="st">'add_2'</span>, add_1, add<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a>test_eq(add_2(<span class="dv">2</span>), <span class="dv">4</span>)</span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">str</span>(add_2), <span class="st">"add_2"</span>)</span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> _A():</span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, add<span class="op">=</span><span class="dv">1</span>): <span class="va">self</span>.add <span class="op">=</span> add</span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, x): <span class="cf">return</span> x <span class="op">+</span> <span class="va">self</span>.add</span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a>test_eq(_A()(<span class="dv">1</span>), <span class="dv">2</span>)</span>
<span id="cb232-15"><a href="#cb232-15" aria-hidden="true" tabindex="-1"></a>_A2 <span class="op">=</span> partial(_A, add<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb232-16"><a href="#cb232-16" aria-hidden="true" tabindex="-1"></a>test_eq(_A2()(<span class="dv">1</span>), <span class="dv">3</span>)</span>
<span id="cb232-17"><a href="#cb232-17" aria-hidden="true" tabindex="-1"></a>test_ne(<span class="bu">str</span>(_A2), <span class="st">'_A2'</span>)</span>
<span id="cb232-18"><a href="#cb232-18" aria-hidden="true" tabindex="-1"></a>_A2 <span class="op">=</span> named_partial(<span class="st">'_A2'</span>, _A, add<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb232-19"><a href="#cb232-19" aria-hidden="true" tabindex="-1"></a>test_eq(_A2()(<span class="dv">1</span>), <span class="dv">3</span>)</span>
<span id="cb232-20"><a href="#cb232-20" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">str</span>(_A2), <span class="st">'_A2'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1170" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="yaml2dict" class="level3">
<h3 class="anchored" data-anchor-id="yaml2dict">yaml2dict</h3>
<blockquote class="blockquote">
<pre><code> yaml2dict (fname)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>program: wandb_scripts<span class="op">/</span>train_script.py          <span class="co"># (required) Path to training script.</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>method: bayes                                   <span class="co"># (required) Specify the search strategy: grid, random or bayes</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>parameters:                                     <span class="co"># (required) Specify parameters bounds to search.</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>   bs:</span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>      values: [<span class="dv">32</span>, <span class="dv">64</span>, <span class="dv">128</span>]</span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>   depth:</span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>      values: [<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>]</span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>   fc_dropout:</span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>      distribution: uniform</span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>      <span class="bu">min</span>: <span class="fl">0.</span></span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a>      <span class="bu">max</span>: <span class="fl">0.5</span></span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a>   lr_max:</span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a>      values: [<span class="fl">0.001</span>, <span class="fl">0.003</span>, <span class="fl">0.01</span>, <span class="fl">0.03</span>, <span class="fl">0.1</span>]</span>
<span id="cb234-14"><a href="#cb234-14" aria-hidden="true" tabindex="-1"></a>   n_epoch:</span>
<span id="cb234-15"><a href="#cb234-15" aria-hidden="true" tabindex="-1"></a>      values: [<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>]</span>
<span id="cb234-16"><a href="#cb234-16" aria-hidden="true" tabindex="-1"></a>   nb_filters:</span>
<span id="cb234-17"><a href="#cb234-17" aria-hidden="true" tabindex="-1"></a>      values: [<span class="dv">32</span>, <span class="dv">64</span>, <span class="dv">128</span>]</span>
<span id="cb234-18"><a href="#cb234-18" aria-hidden="true" tabindex="-1"></a>name: LSST_sweep_01</span>
<span id="cb234-19"><a href="#cb234-19" aria-hidden="true" tabindex="-1"></a>metric: </span>
<span id="cb234-20"><a href="#cb234-20" aria-hidden="true" tabindex="-1"></a>   name: accuracy                              <span class="co"># This must match one of the metrics in the training script</span></span>
<span id="cb234-21"><a href="#cb234-21" aria-hidden="true" tabindex="-1"></a>   goal: maximize</span>
<span id="cb234-22"><a href="#cb234-22" aria-hidden="true" tabindex="-1"></a>early_terminate: </span>
<span id="cb234-23"><a href="#cb234-23" aria-hidden="true" tabindex="-1"></a>   <span class="bu">type</span>: hyperband</span>
<span id="cb234-24"><a href="#cb234-24" aria-hidden="true" tabindex="-1"></a>   min_iter: <span class="dv">3</span></span>
<span id="cb234-25"><a href="#cb234-25" aria-hidden="true" tabindex="-1"></a>project: LSST_wandb_hpo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Writing sweep_config.yaml</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">"sweep_config.yaml"</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>sweep_config <span class="op">=</span> yaml2dict(fname)</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sweep_config)</span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>test_eq(sweep_config.method, <span class="st">'bayes'</span>)</span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>test_eq(sweep_config[<span class="st">'metric'</span>], {<span class="st">'name'</span>: <span class="st">'accuracy'</span>, <span class="st">'goal'</span>: <span class="st">'maximize'</span>})</span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>os.remove(fname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'program': 'wandb_scripts/train_script.py', 'method': 'bayes', 'parameters': {'bs': {'values': [32, 64, 128]}, 'depth': {'values': [3, 6, 9, 12]}, 'fc_dropout': {'distribution': 'uniform', 'min': 0.0, 'max': 0.5}, 'lr_max': {'values': [0.001, 0.003, 0.01, 0.03, 0.1]}, 'n_epoch': {'values': [10, 15, 20]}, 'nb_filters': {'values': [32, 64, 128]}}, 'name': 'LSST_sweep_01', 'metric': {'name': 'accuracy', 'goal': 'maximize'}, 'early_terminate': {'type': 'hyperband', 'min_iter': 3}, 'project': 'LSST_wandb_hpo'}</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1193" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_cat_cols" class="level3">
<h3 class="anchored" data-anchor-id="get_cat_cols">get_cat_cols</h3>
<blockquote class="blockquote">
<pre><code> get_cat_cols (df)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1190" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_cont_cols" class="level3">
<h3 class="anchored" data-anchor-id="get_cont_cols">get_cont_cols</h3>
<blockquote class="blockquote">
<pre><code> get_cont_cols (df)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1184" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="str2index" class="level3">
<h3 class="anchored" data-anchor-id="str2index">str2index</h3>
<blockquote class="blockquote">
<pre><code> str2index (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1177" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="str2list" class="level3">
<h3 class="anchored" data-anchor-id="str2list">str2list</h3>
<blockquote class="blockquote">
<pre><code> str2list (o)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1210" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="map_array" class="level3">
<h3 class="anchored" data-anchor-id="map_array">map_array</h3>
<blockquote class="blockquote">
<pre><code> map_array (arr, dim=1)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1203" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_mapping" class="level3">
<h3 class="anchored" data-anchor-id="get_mapping">get_mapping</h3>
<blockquote class="blockquote">
<pre><code> get_mapping (arr, dim=1, return_counts=False)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.asarray(alphabet[np.random.randint(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">30</span>)]).reshape(<span class="dv">10</span>,<span class="dv">3</span>)</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.asarray(ALPHABET[np.random.randint(<span class="dv">6</span>,<span class="dv">10</span>,<span class="dv">30</span>)]).reshape(<span class="dv">10</span>,<span class="dv">3</span>)</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> concat(a,b,dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>maps, counts <span class="op">=</span> get_mapping(x, dim<span class="op">=</span><span class="dv">1</span>, return_counts<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>x, maps, counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(array([['j', 'b', 'j', 'H', 'G', 'G'],
        ['e', 'k', 'k', 'G', 'J', 'H'],
        ['k', 'b', 'f', 'I', 'I', 'I'],
        ['n', 'j', 'm', 'G', 'G', 'G'],
        ['h', 'n', 'o', 'G', 'H', 'H'],
        ['a', 'a', 'd', 'J', 'G', 'I'],
        ['k', 'n', 'd', 'G', 'I', 'J'],
        ['l', 'l', 'n', 'G', 'I', 'G'],
        ['f', 'o', 'h', 'H', 'H', 'J'],
        ['f', 'i', 'f', 'J', 'G', 'H']], dtype='&lt;U1'),
 [(#8) ['a','e','f','h','j','k','l','n'],
  (#8) ['a','b','i','j','k','l','n','o'],
  (#8) ['d','f','h','j','k','m','n','o'],
  (#4) ['G','H','I','J'],
  (#4) ['G','H','I','J'],
  (#4) ['G','H','I','J']],
 [8, 8, 8, 4, 4, 4])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.asarray(alphabet[np.random.randint(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">30</span>)]).reshape(<span class="dv">10</span>,<span class="dv">3</span>)</span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>x, map_array(x), map_array(x, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(array([['g', 'g', 'j'],
        ['f', 'n', 'k'],
        ['n', 'h', 'm'],
        ['d', 'm', 'i'],
        ['a', 'm', 'g'],
        ['k', 'e', 'm'],
        ['j', 'o', 'm'],
        ['d', 'f', 'f'],
        ['o', 'm', 'b'],
        ['o', 'c', 'b']], dtype='&lt;U1'),
 array([[3, 3, 4],
        [2, 6, 5],
        [6, 4, 6],
        [1, 5, 3],
        [0, 5, 2],
        [5, 1, 6],
        [4, 7, 6],
        [1, 2, 1],
        [7, 5, 0],
        [7, 0, 0]]),
 array([[3, 3, 4],
        [2, 6, 5],
        [6, 4, 6],
        [1, 5, 3],
        [0, 5, 2],
        [5, 1, 6],
        [4, 7, 6],
        [1, 2, 1],
        [7, 5, 0],
        [7, 0, 0]]))</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1216" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="log_tfm" class="level3">
<h3 class="anchored" data-anchor-id="log_tfm">log_tfm</h3>
<blockquote class="blockquote">
<pre><code> log_tfm (o, inplace=False)</code></pre>
</blockquote>
<p>Log transforms an array-like object with positive and/or negative values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.asarray([<span class="op">-</span><span class="dv">1000</span>, <span class="op">-</span><span class="dv">100</span>, <span class="op">-</span><span class="dv">10</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>]).astype(<span class="bu">float</span>)</span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>plt.plot(arr, log_tfm(arr, <span class="va">False</span>))</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-217-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> tensor([<span class="op">-</span><span class="dv">1000</span>, <span class="op">-</span><span class="dv">100</span>, <span class="op">-</span><span class="dv">10</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>]).<span class="bu">float</span>()</span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>plt.plot(t, log_tfm(t, <span class="va">False</span>))</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-218-output-1.png" class="img-fluid"></p>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1236" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="to_sincos_time" class="level3">
<h3 class="anchored" data-anchor-id="to_sincos_time">to_sincos_time</h3>
<blockquote class="blockquote">
<pre><code> to_sincos_time (arr, max_value)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.sort(np.random.rand(<span class="dv">100</span>) <span class="op">*</span> <span class="dv">5</span>)</span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>arr_sin, arr_cos <span class="op">=</span> to_sincos_time(arr, <span class="dv">5</span>)</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>plt.scatter(arr, arr_sin)</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>plt.scatter(arr, arr_cos)</span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-220-output-1.png" class="img-fluid"></p>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1242" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_feature_dist" class="level3">
<h3 class="anchored" data-anchor-id="plot_feature_dist">plot_feature_dist</h3>
<blockquote class="blockquote">
<pre><code> plot_feature_dist (X, percentiles=[0, 0.1, 0.5, 1, 5, 10, 25, 50, 75, 90,
                    95, 99, 99.5, 99.9, 100])</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.random.rand(<span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>plot_feature_dist(arr, percentiles<span class="op">=</span>[<span class="dv">0</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">90</span>,<span class="dv">95</span>,<span class="dv">99</span>,<span class="fl">99.5</span>,<span class="fl">99.9</span>,<span class="dv">100</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-222-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-222-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-222-output-3.png" class="img-fluid"></p>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1254" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="rolling_moving_average" class="level3">
<h3 class="anchored" data-anchor-id="rolling_moving_average">rolling_moving_average</h3>
<blockquote class="blockquote">
<pre><code> rolling_moving_average (o, window=2)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.arange(<span class="dv">60</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>).astype(<span class="bu">float</span>)</span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.arange(<span class="dv">60</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>).<span class="bu">float</span>()</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>test_close(rolling_moving_average(a, window<span class="op">=</span><span class="dv">3</span>), rolling_moving_average(t, window<span class="op">=</span><span class="dv">3</span>).numpy())</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(t)</span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rolling_moving_average(t, window<span class="op">=</span><span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([[[ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9.],
         [10., 11., 12., 13., 14., 15., 16., 17., 18., 19.],
         [20., 21., 22., 23., 24., 25., 26., 27., 28., 29.]],

        [[30., 31., 32., 33., 34., 35., 36., 37., 38., 39.],
         [40., 41., 42., 43., 44., 45., 46., 47., 48., 49.],
         [50., 51., 52., 53., 54., 55., 56., 57., 58., 59.]]])
tensor([[[ 0.0000,  0.5000,  1.0000,  2.0000,  3.0000,  4.0000,  5.0000,
           6.0000,  7.0000,  8.0000],
         [10.0000, 10.5000, 11.0000, 12.0000, 13.0000, 14.0000, 15.0000,
          16.0000, 17.0000, 18.0000],
         [20.0000, 20.5000, 21.0000, 22.0000, 23.0000, 24.0000, 25.0000,
          26.0000, 27.0000, 28.0000]],

        [[30.0000, 30.5000, 31.0000, 32.0000, 33.0000, 34.0000, 35.0000,
          36.0000, 37.0000, 38.0000],
         [40.0000, 40.5000, 41.0000, 42.0000, 43.0000, 44.0000, 45.0000,
          46.0000, 47.0000, 48.0000],
         [50.0000, 50.5000, 51.0000, 52.0000, 53.0000, 54.0000, 55.0000,
          56.0000, 57.0000, 58.0000]]])</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1291" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="fbfill_sequence" class="level3">
<h3 class="anchored" data-anchor-id="fbfill_sequence">fbfill_sequence</h3>
<blockquote class="blockquote">
<pre><code> fbfill_sequence (o)</code></pre>
</blockquote>
<p>Forward and backward fills an array-like object alongside sequence dimension</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1280" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="bfill_sequence" class="level3">
<h3 class="anchored" data-anchor-id="bfill_sequence">bfill_sequence</h3>
<blockquote class="blockquote">
<pre><code> bfill_sequence (o)</code></pre>
</blockquote>
<p>Backward fills an array-like object alongside sequence dimension</p>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1267" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="ffill_sequence" class="level3">
<h3 class="anchored" data-anchor-id="ffill_sequence">ffill_sequence</h3>
<blockquote class="blockquote">
<pre><code> ffill_sequence (o)</code></pre>
</blockquote>
<p>Forward fills an array-like object alongside sequence dimension</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.arange(<span class="dv">80</span>).reshape(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">10</span>).astype(<span class="bu">float</span>)</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.random.rand(<span class="op">*</span>a.shape)</span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a>a[mask <span class="op">&gt;</span> <span class="fl">.8</span>] <span class="op">=</span> np.nan</span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.from_numpy(a)</span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>tensor([[[ 0.,  1.,  2.,  3.,  4.,  5.,  6., nan,  8.,  9.],
         [10., 11., 12., 13., 14., 15., 16., 17., nan, nan],
         [nan, nan, 22., nan, 24., 25., 26., 27., 28., 29.],
         [nan, 31., nan, 33., 34., 35., 36., nan, nan, 39.]],

        [[40., nan, 42., 43., 44., 45., 46., 47., 48., 49.],
         [50., nan, 52., 53., nan, 55., 56., 57., 58., nan],
         [nan, 61., 62., 63., 64., nan, 66., 67., 68., 69.],
         [nan, nan, 72., 73., 74., 75., nan, 77., 78., nan]]],
       dtype=torch.float64)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># forward fill</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>filled_a <span class="op">=</span> ffill_sequence(a)</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(filled_a)</span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> np.isnan(filled_a)</span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>test_eq(filled_a[<span class="op">~</span>m], ffill_sequence(t).numpy()[<span class="op">~</span>m])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[[ 0.  1.  2.  3.  4.  5.  6.  6.  8.  9.]
  [10. 11. 12. 13. 14. 15. 16. 17. 17. 17.]
  [nan nan 22. 22. 24. 25. 26. 27. 28. 29.]
  [nan 31. 31. 33. 34. 35. 36. 36. 36. 39.]]

 [[40. 40. 42. 43. 44. 45. 46. 47. 48. 49.]
  [50. 50. 52. 53. 53. 55. 56. 57. 58. 58.]
  [nan 61. 62. 63. 64. 64. 66. 67. 68. 69.]
  [nan nan 72. 73. 74. 75. 75. 77. 78. 78.]]]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># backward fill</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>filled_a <span class="op">=</span> bfill_sequence(a)</span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(filled_a)</span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> np.isnan(filled_a)</span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a>test_eq(filled_a[<span class="op">~</span>m], bfill_sequence(t).numpy()[<span class="op">~</span>m])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[[ 0.  1.  2.  3.  4.  5.  6.  8.  8.  9.]
  [10. 11. 12. 13. 14. 15. 16. 17. nan nan]
  [22. 22. 22. 24. 24. 25. 26. 27. 28. 29.]
  [31. 31. 33. 33. 34. 35. 36. 39. 39. 39.]]

 [[40. 42. 42. 43. 44. 45. 46. 47. 48. 49.]
  [50. 52. 52. 53. 55. 55. 56. 57. 58. nan]
  [61. 61. 62. 63. 64. 66. 66. 67. 68. 69.]
  [72. 72. 72. 73. 74. 75. 77. 77. 78. nan]]]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># forward &amp; backward fill</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>filled_a <span class="op">=</span> fbfill_sequence(a)</span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(filled_a)</span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> np.isnan(filled_a)</span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>test_eq(filled_a[<span class="op">~</span>m], fbfill_sequence(t).numpy()[<span class="op">~</span>m])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[[ 0.  1.  2.  3.  4.  5.  6.  6.  8.  9.]
  [10. 11. 12. 13. 14. 15. 16. 17. 17. 17.]
  [22. 22. 22. 22. 24. 25. 26. 27. 28. 29.]
  [31. 31. 31. 33. 34. 35. 36. 36. 36. 39.]]

 [[40. 40. 42. 43. 44. 45. 46. 47. 48. 49.]
  [50. 50. 52. 53. 53. 55. 56. 57. 58. 58.]
  [61. 61. 62. 63. 64. 64. 66. 67. 68. 69.]
  [72. 72. 72. 73. 74. 75. 75. 77. 78. 78.]]]</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1298" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="dummify" class="level3">
<h3 class="anchored" data-anchor-id="dummify">dummify</h3>
<blockquote class="blockquote">
<pre><code> dummify (o:Union[numpy.ndarray,torch.Tensor], by_var:bool=True,
          inplace:bool=False, skip:Optional[list]=None, random_state=None)</code></pre>
</blockquote>
<p>Shuffles an array-like object along all dimensions or dimension 1 (variables) if by_var is True.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.random.rand(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>)</span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>arr_original <span class="op">=</span> arr.copy()</span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>dummy_arr <span class="op">=</span> dummify(arr)</span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>test_ne(arr_original, dummy_arr)</span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>test_eq(arr_original, arr)</span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a>dummify(arr, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a>test_ne(arr_original, arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> torch.rand(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>)</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>t_original <span class="op">=</span> t.clone()</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>dummy_t <span class="op">=</span> dummify(t)</span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>test_ne(t_original, dummy_t)</span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>test_eq(t_original, t)</span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a>dummify(t, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a>test_ne(t_original, t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1314" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="shuffle_along_axis" class="level3">
<h3 class="anchored" data-anchor-id="shuffle_along_axis">shuffle_along_axis</h3>
<blockquote class="blockquote">
<pre><code> shuffle_along_axis (o, axis=-1, random_state=None)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.arange(<span class="dv">60</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>) <span class="op">+</span> <span class="dv">10</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>X_shuffled <span class="op">=</span> shuffle_along_axis(X,(<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>), random_state<span class="op">=</span><span class="dv">23</span>)</span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>test_eq(X_shuffled, np.array([[[<span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">41</span>, <span class="dv">14</span>, <span class="dv">40</span>, <span class="dv">49</span>, <span class="dv">18</span>, <span class="dv">42</span>, <span class="dv">47</span>, <span class="dv">46</span>],</span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>                               [<span class="dv">28</span>, <span class="dv">56</span>, <span class="dv">53</span>, <span class="dv">50</span>, <span class="dv">52</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">57</span>, <span class="dv">51</span>, <span class="dv">59</span>],</span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a>                               [<span class="dv">34</span>, <span class="dv">30</span>, <span class="dv">38</span>, <span class="dv">35</span>, <span class="dv">69</span>, <span class="dv">66</span>, <span class="dv">63</span>, <span class="dv">67</span>, <span class="dv">61</span>, <span class="dv">62</span>]],</span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-7"><a href="#cb273-7" aria-hidden="true" tabindex="-1"></a>                              [[<span class="dv">19</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">16</span>, <span class="dv">43</span>, <span class="dv">12</span>, <span class="dv">17</span>, <span class="dv">48</span>, <span class="dv">45</span>, <span class="dv">44</span>],</span>
<span id="cb273-8"><a href="#cb273-8" aria-hidden="true" tabindex="-1"></a>                               [<span class="dv">23</span>, <span class="dv">20</span>, <span class="dv">26</span>, <span class="dv">22</span>, <span class="dv">21</span>, <span class="dv">27</span>, <span class="dv">58</span>, <span class="dv">29</span>, <span class="dv">54</span>, <span class="dv">55</span>],</span>
<span id="cb273-9"><a href="#cb273-9" aria-hidden="true" tabindex="-1"></a>                               [<span class="dv">36</span>, <span class="dv">31</span>, <span class="dv">39</span>, <span class="dv">60</span>, <span class="dv">33</span>, <span class="dv">68</span>, <span class="dv">37</span>, <span class="dv">32</span>, <span class="dv">65</span>, <span class="dv">64</span>]]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1350" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="analyze_array" class="level3">
<h3 class="anchored" data-anchor-id="analyze_array">analyze_array</h3>
<blockquote class="blockquote">
<pre><code> analyze_array (o, bins=100, density=False, feature_names=None,
                clip_outliers_plot=False, quantile_range=(25.0, 75.0),
                percentiles=[1, 25, 50, 75, 99], text_len=12, figsize=(10,
                6))</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1323" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="analyze_feature" class="level3">
<h3 class="anchored" data-anchor-id="analyze_feature">analyze_feature</h3>
<blockquote class="blockquote">
<pre><code> analyze_feature (feature, bins=100, density=False, feature_name=None,
                  clip_outliers_plot=False, quantile_range=(25.0, 75.0),
                  percentiles=[1, 25, 50, 75, 99], text_len=12,
                  figsize=(10, 6))</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.normal(size<span class="op">=</span>(<span class="dv">1000</span>))</span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>analyze_array(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> array shape: (1000,)
       dtype: float64
  nan values: 0.0%
         max: 3.137035754147785
           1: -2.265136762541489
          25: -0.7704682535293808
          50: -0.05691499744372562
          75: 0.6308870334033057
          99: 2.1327776024135403
         min: -3.0789286262271416
 outlier min: -2.8725011839284105
 outlier max: 2.7329199638023356
    outliers: 0.6%
        mean: -0.05758672633619717
         std: 0.9965460593961707
 normal dist: True</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-239-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.random.normal(size<span class="op">=</span>(<span class="dv">1000</span>,<span class="dv">2</span>))</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.random.normal(<span class="dv">3</span>, <span class="dv">5</span>, size<span class="op">=</span>(<span class="dv">1000</span>,<span class="dv">2</span>))</span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x1 <span class="op">+</span> x2</span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>analyze_array(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> array shape: (1000, 2)

  0  feature: 0

       dtype: float64
  nan values: 0.0%
         max: 16.73984264237124
           1: -8.723473567460799
          25: -0.17793796541912255
          50: 3.274863767443181
          75: 6.6907353625592885
          99: 14.500914416198908
         min: -11.577982938283466
 outlier min: -10.48094795738674
 outlier max: 16.993745354526904
    outliers: 0.4%
        mean: 3.169288154625591
         std: 5.044150859017613
 normal dist: True</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-240-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1  feature: 1

       dtype: float64
  nan values: 0.0%
         max: 20.957127202590673
           1: -8.824108128141859
          25: -0.897728643391843
          50: 2.8914228957756456
          75: 6.259028902145111
          99: 13.779579280779982
         min: -13.663138311819605
 outlier min: -11.632864961697274
 outlier max: 16.99416522045054
    outliers: 0.4%
        mean: 2.82001817965573
         std: 5.043842374595266
 normal dist: True</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="002_utils_files/figure-html/cell-240-output-4.png" class="img-fluid"></p>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1364" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_relpath" class="level3">
<h3 class="anchored" data-anchor-id="get_relpath">get_relpath</h3>
<blockquote class="blockquote">
<pre><code> get_relpath (path)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1375" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="split_in_chunks" class="level3">
<h3 class="anchored" data-anchor-id="split_in_chunks">split_in_chunks</h3>
<blockquote class="blockquote">
<pre><code> split_in_chunks (o, chunksize, start=0, shuffle=False, drop_last=False)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.arange(<span class="dv">5</span>, <span class="dv">15</span>)</span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>test_eq(split_in_chunks(a, <span class="dv">3</span>, drop_last<span class="op">=</span><span class="va">False</span>), [array([<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>]), array([ <span class="dv">8</span>,  <span class="dv">9</span>, <span class="dv">10</span>]), array([<span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>]), array([<span class="dv">14</span>])])</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>test_eq(split_in_chunks(a, <span class="dv">3</span>, drop_last<span class="op">=</span><span class="va">True</span>), [array([<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>]), array([ <span class="dv">8</span>,  <span class="dv">9</span>, <span class="dv">10</span>]), array([<span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>])])</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>test_eq(split_in_chunks(a, <span class="dv">3</span>, start<span class="op">=</span><span class="dv">2</span>, drop_last<span class="op">=</span><span class="va">True</span>), [array([<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]), array([<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>])])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1392" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="load_object" class="level3">
<h3 class="anchored" data-anchor-id="load_object">load_object</h3>
<blockquote class="blockquote">
<pre><code> load_object (file_path)</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1384" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="save_object" class="level3">
<h3 class="anchored" data-anchor-id="save_object">save_object</h3>
<blockquote class="blockquote">
<pre><code> save_object (o, file_path, verbose=True)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>split <span class="op">=</span> np.arange(<span class="dv">100</span>)</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>save_object(split, file_path<span class="op">=</span><span class="st">'data/test'</span>)</span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>split2 <span class="op">=</span> load_object(<span class="st">'data/test.pkl'</span>)</span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>test_eq(split, split2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>data directory already exists.
ndarray saved as data/test.pkl</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>splits <span class="op">=</span> L([[[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>], [<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>]],[[<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>], [<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">19</span>]]])</span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>save_object(splits, file_path<span class="op">=</span>Path(<span class="st">'data/test'</span>))</span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>splits2 <span class="op">=</span> load_object(<span class="st">'data/test'</span>)</span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a>test_eq(splits, splits2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>data directory already exists.
L saved as data/test.pkl</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1399" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_idxs_to_keep" class="level3">
<h3 class="anchored" data-anchor-id="get_idxs_to_keep">get_idxs_to_keep</h3>
<blockquote class="blockquote">
<pre><code> get_idxs_to_keep (o, cond, crit='all', invert=False, axis=(1, 2),
                   keepdims=False)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.rand(<span class="dv">100</span>, <span class="dv">2</span>, <span class="dv">10</span>)</span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>a[a <span class="op">&gt;</span> <span class="fl">.95</span>] <span class="op">=</span> np.nan</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>idxs_to_keep <span class="op">=</span> get_idxs_to_keep(a, np.isfinite)</span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> idxs_to_keep.size<span class="op">&gt;</span><span class="dv">0</span>: </span>
<span id="cb291-5"><a href="#cb291-5" aria-hidden="true" tabindex="-1"></a>    test_eq(np.isnan(a[idxs_to_keep]).<span class="bu">sum</span>(), <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><a href="https://github.com/timeseriesAI/tsai/blob/main/tsai/utils.py#L1419" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="zerofy" class="level3">
<h3 class="anchored" data-anchor-id="zerofy">zerofy</h3>
<blockquote class="blockquote">
<pre><code> zerofy (a, stride, keep=False)</code></pre>
</blockquote>
<p>Create copies of an array setting individual/ group values to zero</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>stride <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.arange(<span class="dv">2</span><span class="op">*</span><span class="dv">5</span>).reshape(<span class="dv">2</span>,<span class="dv">5</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>zerofy(a, stride, keep<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([[[ 0.,  0.,  3.,  4.,  5.],
        [ 6.,  7.,  8.,  9., 10.]],

       [[ 1.,  2.,  0.,  0.,  0.],
        [ 6.,  7.,  8.,  9., 10.]],

       [[ 1.,  2.,  3.,  4.,  5.],
        [ 0.,  0.,  8.,  9., 10.]],

       [[ 1.,  2.,  3.,  4.,  5.],
        [ 6.,  7.,  0.,  0.,  0.]]])</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>